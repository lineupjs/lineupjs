/*! lineupjs - v0.5.4 - 2016
* https://github.com/Caleydo/lineup.js
* Copyright (c) 2016 Caleydo Team; Licensed BSD-3-Clause*/
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("d3")):"function"==typeof define&&define.amd?define(["d3"],e):"object"==typeof exports?exports.LineUpJS=e(require("d3")):t.LineUpJS=e(t.d3)}(this,function(t){return function(t){function e(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,e),i.l=!0,i.exports}var n={};return e.m=t,e.c=n,e.i=function(t){return t},e.d=function(t,e,n){Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:n})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=9)}([function(e,n){e.exports=t},function(t,e,n){"use strict";function r(t,e,n){void 0===e&&(e=100),void 0===n&&(n=this);var r=-1;return function(){for(var i=[],o=0;o<arguments.length;o++)i[o-0]=arguments[o];r>=0&&(clearTimeout(r),r=-1),i.unshift(null===n?this:n),r=setTimeout(t.bind.apply(t,i),e)}}function i(t,e){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r-0]=arguments[r];n.unshift(e||this.type),t.fire.apply(t,n)}}function o(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];for(var n=null,r=0;r<t.length;r++){var i=t[r],a=Object.keys(i);if(null!==n)for(var s=0;s<a.length;s++){var l=a[s],c=i[l];Object.prototype.toString.call(c)===f&&Object.getPrototypeOf(c)===Object.prototype?(void 0===n[l]&&(n[l]={}),n[l]=o(n[l],c)):Object.prototype.toString.call(c)===g?(void 0===n[l]&&(n[l]=[]),n[l]=c.concat(n[l])):n[l]=c}else n=i}return n}function a(t){var e=t.getBoundingClientRect();return{left:e.left+window.pageXOffset,top:e.top+window.pageYOffset,width:e.width,height:e.height}}function s(t,e){var n=t.dataTransfer.types;return"function"==typeof n.indexOf?e.some(function(t){return n.indexOf(t)>=0}):"function"==typeof n.includes?e.some(function(t){return n.includes(t)}):"function"==typeof n.contains&&e.some(function(t){return n.contains(t)})}function l(t){var e=t.dataTransfer;return t.ctrlKey&&null!=e.effectAllowed.match(/copy/gi)||null==e.effectAllowed.match(/move/gi)}function c(t){var e=t.dataTransfer;l(t)?e.dropEffect="copy":e.dropEffect="move"}function u(t,e){return function(r){r.on("dragenter",function(){var e=p.event;return s(e,t)?(n.i(p.select)(this).classed("drag_over",!0),!1):void n.i(p.select)(this).classed("drag_over",!1)}).on("dragover",function(){var e=p.event;if(s(e,t))return e.preventDefault(),c(e),n.i(p.select)(this).classed("drag_over",!0),!1}).on("dragleave",function(){n.i(p.select)(this).classed("drag_over",!1)}).on("drop",function(r){var i=p.event;if(i.preventDefault(),n.i(p.select)(this).classed("drag_over",!1),s(i,t)){var o={};return t.forEach(function(t){var e=i.dataTransfer.getData(t);""!==e&&(o[t]=e)}),e(o,r,l(i))}})}}var p=n(0);n.n(p);e.delayedCall=r,e.forwardEvent=i,n.d(e,"AEventDispatcher",function(){return h}),e.merge=o,e.offset=a,n.d(e,"ContentScroller",function(){return m}),e.hasDnDType=s,e.copyDnD=l,e.updateDropEffect=c,e.dropAble=u;var d=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},h=function(){function t(){this.forwarder=i(this),this.listeners=p.dispatch.apply(void 0,this.createEventList())}return t.prototype.on=function(t,e){var n=this;return arguments.length>1?(Array.isArray(t)?t.forEach(function(t){return n.listeners.on(t,e)}):this.listeners.on(t,e),this):this.listeners.on(t)},t.prototype.createEventList=function(){return[]},t.prototype.fire=function(t){for(var e=this,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var i=function(t){var r={source:e,type:t,args:n};e.listeners[t].apply(r,n)};Array.isArray(t)?t.forEach(i.bind(this)):i(t)},t.prototype.forward=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];t.on(e,this.forwarder)},t.prototype.unforward=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];t.on(e,null)},t}(),f="[object Object]",g="[object Array]",m=function(t){function e(e,r,i){var s=this;void 0===i&&(i={}),t.call(this),this.container=e,this.content=r,this.options={topShift:function(){return 0},backupRows:5,rowHeight:10},this.prevScrollTop=0,this.shift=0,o(this.options,i),n.i(p.select)(e).on("scroll.scroller",function(){return s.onScroll()}),this.prevScrollTop=e.scrollTop,this.shift=a(r).top-a(e).top}return d(e,t),e.prototype.createEventList=function(){return t.prototype.createEventList.call(this).concat(["scroll","redraw"])},e.prototype.scrollIntoView=function(t,e,n,r){var i=this.select(t,e,r);if(!(i.from<=n&&n<=i.to)){var o,a=this.container.scrollTop-this.shift-this.options.topShift(),s=a+this.container.clientHeight,l=0;if(a>0){for(l=Math.round(a/this.options.rowHeight);l>=t&&r(l+1)>a;)l--;l-=this.options.backupRows}for(o=Math.round(s/this.options.rowHeight);o<=e&&r(o-1)<s;)o++;o+=this.options.backupRows}},e.prototype.select=function(t,e,n){var r,i=this.container.scrollTop-this.shift-this.options.topShift(),o=i+this.container.clientHeight,a=0;if(i>0){for(a=Math.round(i/this.options.rowHeight);a>=t&&n(a+1)>i;)a--;a-=this.options.backupRows}for(r=Math.round(o/this.options.rowHeight);r<=e&&n(r-1)<o;)r++;return r+=this.options.backupRows,{from:Math.max(a,t),to:Math.min(r,e)}},e.prototype.onScroll=function(){var t=this.container.scrollTop,e=this.container.scrollLeft;this.fire("scroll",t,e),Math.abs(this.prevScrollTop-t)>=this.options.rowHeight*this.options.backupRows&&(this.prevScrollTop=t,this.fire("redraw"))},e.prototype.destroy=function(){n.i(p.select)(this.container).on("scroll.scroller",null)},e}(h)},function(t,e,n){"use strict";function r(t){return t.replace(/[\s!#$%&'\(\)\*\+,\.\/:;<=>\?@\[\\\]\^`\{\|}~]/g,"_")}function i(t,e){return t===e||isNaN(t)&&isNaN(e)?0:t-e}function o(t){return t instanceof b&&"function"==typeof t.getNumber||!(t instanceof b)&&null!=t.type.match(/(number|stack|ordinal)/)}function a(t){return t instanceof b&&"function"==typeof t.getCategories||!(t instanceof b)&&null!=t.type.match(/(categorical|ordinal)/)}function s(t){switch(void 0===t&&(t="linear"),t){case"log":return m.scale.log().clamp(!0);case"sqrt":return m.scale.sqrt().clamp(!0);case"pow1.1":return m.scale.pow().exponent(1.1).clamp(!0);case"pow2":return m.scale.pow().exponent(2).clamp(!0);case"pow3":return m.scale.pow().exponent(3).clamp(!0);default:return m.scale.linear().clamp(!0)}}function l(t,e){return t.length===e.length&&t.every(function(t,n){return t===e[n]})}function c(t,e){return"log"===e&&0===t[0]&&(t[0]=1e-7),t}function u(t){if("script"===t.type){var e=new w;return e.restore(t),e}var n=new k;return n.restore(t),n}function p(t,e){var n=null!=t?t.length:0,r=null!=e?e.length:0;return n===r&&(0===n||t.every(function(t,n){return t===e[n]}))}function d(t){return"function"==typeof t.getCollapsed}function h(t,e){void 0===e&&(e={});var r=function(t){function e(e,n){t.call(this,e,n),"function"==typeof this.init&&this.init.apply(this,[].slice.apply(arguments))}return v(e,t),e}(C);return r.prototype.toString=function(){return t},r.prototype=n.i(y.merge)(r.prototype,e),r}function f(t){return void 0===t&&(t="actions"),{type:"actions",label:t}}function g(){return{number:_,string:E,link:L,stack:A,rank:j,boolean:F,categorical:P,ordinal:O,actions:x,annotate:S,selection:R,max:H,min:N,mean:N,script:I,nested:W}}var m=n(0),y=(n.n(m),n(1));n.d(e,"Column",function(){return b}),n.d(e,"ValueColumn",function(){return C}),n.d(e,"DummyColumn",function(){return x}),e.isNumberColumn=o,e.isCategoricalColumn=a,n.d(e,"ScaleMappingFunction",function(){return k}),n.d(e,"ScriptMappingFunction",function(){return w}),e.createMappingFunction=u,n.d(e,"NumberColumn",function(){return _}),n.d(e,"StringColumn",function(){return E}),n.d(e,"LinkColumn",function(){return L}),n.d(e,"AnnotateColumn",function(){return S}),n.d(e,"SelectionColumn",function(){return R}),n.d(e,"BooleanColumn",function(){return F}),n.d(e,"CategoricalColumn",function(){return P}),n.d(e,"CategoricalNumberColumn",function(){return O}),n.d(e,"CompositeColumn",function(){return V}),n.d(e,"CompositeNumberColumn",function(){return D}),e.isMultiLevelColumn=d,n.d(e,"StackColumn",function(){return A}),n.d(e,"MaxColumn",function(){return H}),n.d(e,"MinColumn",function(){return N}),n.d(e,"MeanColumn",function(){return M}),n.d(e,"MultiLevelCompositeColumn",function(){return T}),n.d(e,"NestedColumn",function(){return W}),n.d(e,"ScriptColumn",function(){return I}),n.d(e,"RankColumn",function(){return j}),n.d(e,"Ranking",function(){return B}),e.defineColumn=h,n.d(e,"createStackDesc",function(){return z}),n.d(e,"createRankDesc",function(){return $}),n.d(e,"createSelectionDesc",function(){return U}),n.d(e,"createMinDesc",function(){return q}),n.d(e,"createMaxDesc",function(){return Y}),n.d(e,"createMeanDesc",function(){return X}),n.d(e,"createNestedDesc",function(){return G}),n.d(e,"createScriptDesc",function(){return K}),e.createActionDesc=f,e.models=g;var v=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},b=function(t){function e(n,i){t.call(this),this.desc=i,this.width=100,this.parent=null,this.compressed=!1,this.id=r(n),this.label=this.desc.label||this.id,this.description=this.desc.description||"",this.cssClass=this.desc.cssClass||"",this.color=this.desc.color||(""!==this.cssClass?null:e.DEFAULT_COLOR)}return v(e,t),Object.defineProperty(e.prototype,"headerCssClass",{get:function(){return this.desc.type},enumerable:!0,configurable:!0}),e.prototype.assignNewId=function(t){this.id=r(t())},e.prototype.init=function(t){return Promise.resolve(!0)},Object.defineProperty(e.prototype,"fqid",{get:function(){return this.parent?this.parent.fqid+"_"+this.id:this.id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fqpath",{get:function(){return this.parent?this.parent.fqpath+"@"+this.parent.indexOf(this):""},enumerable:!0,configurable:!0}),e.prototype.createEventList=function(){return t.prototype.createEventList.call(this).concat(["widthChanged","filterChanged","labelChanged","metaDataChanged","compressChanged","addColumn","removeColumn","dirty","dirtyHeader","dirtyValues"])},e.prototype.getWidth=function(){return this.width},e.prototype.isHidden=function(){return this.width<=0},e.prototype.setCompressed=function(t){this.compressed!==t&&this.fire(["compressChanged","dirtyHeader","dirtyValues","dirty"],this.compressed,this.compressed=t)},e.prototype.getCompressed=function(){return this.compressed},e.prototype.flatten=function(t,n,r,i){void 0===r&&(r=0),void 0===i&&(i=0);var o=this.compressed?e.COMPRESSED_WIDTH:this.getWidth();return t.push({col:this,offset:n,width:o}),o},e.prototype.setWidth=function(t){this.width!==t&&this.fire(["widthChanged","dirtyHeader","dirtyValues","dirty"],this.width,this.width=t)},e.prototype.setWidthImpl=function(t){this.width=t},e.prototype.setMetaData=function(t){if(t.label!==this.label||this.color!==t.color||this.description!==t.description){var e=this.color===t.color?["labelChanged","metaDataChanged","dirtyHeader","dirty"]:["labelChanged","metaDataChanged","dirtyHeader","dirtyValues","dirty"];this.fire(e,this.getMetaData(),{label:this.label=t.label,color:this.color=t.color,description:this.description=t.description})}},e.prototype.getMetaData=function(){return{label:this.label,color:this.color,description:this.description}},e.prototype.sortByMe=function(t){void 0===t&&(t=!1);var e=this.findMyRanker();return!!e&&e.sortBy(this,t)},e.prototype.toggleMySorting=function(){var t=this.findMyRanker();return!!t&&t.toggleSorting(this)},e.prototype.removeMe=function(){return!!this.parent&&this.parent.remove(this)},e.prototype.insertAfterMe=function(t){return!!this.parent&&null!=this.parent.insertAfter(t,this)},e.prototype.findMyRanker=function(){return this.parent?this.parent.findMyRanker():null},e.prototype.dump=function(t){var n={id:this.id,desc:t(this.desc),width:this.width,compressed:this.compressed};return this.label!==(this.desc.label||this.id)&&(n.label=this.label),this.color!==(this.desc.color||e.DEFAULT_COLOR)&&this.color&&(n.color=this.color),n},e.prototype.restore=function(t,e){this.width=t.width||this.width,this.label=t.label||this.label,this.color=t.color||this.color,this.compressed=t.compressed===!0},e.prototype.getLabel=function(t){return""+this.getValue(t)},e.prototype.getValue=function(t){return""},e.prototype.compare=function(t,e){return 0},e.prototype.isFiltered=function(){return!1},e.prototype.filter=function(t){return null!==t},e.DEFAULT_COLOR="#C1C1C1",e.FLAT_ALL_COLUMNS=-1,e.COMPRESSED_WIDTH=16,e}(y.AEventDispatcher),C=function(t){function e(e,n){t.call(this,e,n),this.accessor=n.accessor||function(){return null}}return v(e,t),e.prototype.getLabel=function(t){return""+this.getValue(t)},e.prototype.getValue=function(t){return this.accessor(t,this.id,this.desc,this.findMyRanker())},e.prototype.compare=function(t,e){return 0},e}(b),x=function(t){function e(e,n){t.call(this,e,n)}return v(e,t),e.prototype.getLabel=function(t){return""},e.prototype.getValue=function(t){return""},e.prototype.compare=function(t,e){return 0},e}(b),k=function(){function t(t,e,n){void 0===t&&(t=[0,1]),void 0===e&&(e="linear"),void 0===n&&(n=[0,1]),this.type=e,this.s=s(e).domain(c(t,this.type)).range(n)}return Object.defineProperty(t.prototype,"domain",{get:function(){return this.s.domain()},set:function(t){this.s.domain(c(t,this.type))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"range",{get:function(){return this.s.range()},set:function(t){this.s.range(t)},enumerable:!0,configurable:!0}),t.prototype.apply=function(t){return this.s(t)},Object.defineProperty(t.prototype,"scaleType",{get:function(){return this.type},enumerable:!0,configurable:!0}),t.prototype.dump=function(){return{type:this.type,domain:this.domain,range:this.range}},t.prototype.eq=function(e){if(!(e instanceof t))return!1;var n=e;return n.type===this.type&&l(this.domain,n.domain)&&l(this.range,n.range)},t.prototype.restore=function(t){this.type=t.type,this.s=s(t.type).domain(t.domain).range(t.range)},t.prototype.clone=function(){return new t(this.domain,this.type,this.range)},t}(),w=function(){function t(t,e){void 0===t&&(t=[0,1]),void 0===e&&(e="return this.linear(value,this.value_min,this.value_max);"),this.domain_=t,this.code_=e,this.f=new Function("value",e)}return Object.defineProperty(t.prototype,"domain",{get:function(){return this.domain_},set:function(t){this.domain_=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"code",{get:function(){return this.code_},set:function(t){this.code_!==t&&(this.code_=t,this.f=new Function("value",t))},enumerable:!0,configurable:!0}),t.prototype.apply=function(t){var e=this.domain_[0],n=this.domain_[this.domain_.length-1],r=this.f.call({value_min:e,value_max:n,value_range:n-e,value_domain:this.domain_.slice(),linear:function(t,e,n){return(t-e)/(n-e)}},t);return"number"==typeof r?Math.max(Math.min(r,1),0):NaN},t.prototype.dump=function(){return{type:"script",code:this.code}},t.prototype.eq=function(e){if(!(e instanceof t))return!1;var n=e;return n.code===this.code},t.prototype.restore=function(t){this.code=t.code},t.prototype.clone=function(){return new t(this.domain,this.code)},t}(),_=function(t){function e(e,n){t.call(this,e,n),this.missingValue=0,this.currentFilter={min:-(1/0),max:1/0},this.numberFormat=m.format(".3n"),n.map?this.mapping=u(n.map):n.domain&&(this.mapping=new k(n.domain,"linear",n.range||[0,1])),this.original=this.mapping.clone(),n.numberFormat&&(this.numberFormat=m.format(n.numberFormat))}return v(e,t),e.prototype.init=function(t){var e=this,n=this.mapping.domain;return isNaN(n[0])||isNaN(n[1])?t(this.desc).then(function(t){return e.mapping.domain=[t.min,t.max],e.original.domain=[t.min,t.max],!0}):Promise.resolve(!0)},e.prototype.dump=function(e){var n=t.prototype.dump.call(this,e);return n.map=this.mapping.dump(),n.filter=this.currentFilter,n.missingValue=this.missingValue,n},e.prototype.restore=function(e,n){t.prototype.restore.call(this,e,n),e.map?this.mapping=u(e.map):e.domain&&(this.mapping=new k(e.domain,"linear",e.range||[0,1])),e.currentFilter&&(this.currentFilter=e.currentFilter),e.missingValue&&(this.missingValue=e.missingValue),e.numberFormat&&(this.numberFormat=m.format(e.numberFormat))},e.prototype.createEventList=function(){return t.prototype.createEventList.call(this).concat(["mappingChanged"])},e.prototype.getLabel=function(e){if(this.desc.numberFormat)return this.numberFormat(this.getRawValue(e));var n=t.prototype.getValue.call(this,e);return""+("number"==typeof n?this.numberFormat(+n):n)},e.prototype.getRawValue=function(e){var n=t.prototype.getValue.call(this,e);return"undefined"==typeof n||null==n||isNaN(n)||""===n||"NA"===n||"string"==typeof n&&"na"===n.toLowerCase()?this.missingValue:+n},e.prototype.getValue=function(t){var e=this.getRawValue(t);return isNaN(e)?e:this.mapping.apply(e)},e.prototype.getNumber=function(t){return this.getValue(t)},e.prototype.compare=function(t,e){return i(this.getValue(t),this.getValue(e))},e.prototype.getOriginalMapping=function(){return this.original.clone()},e.prototype.getMapping=function(){return this.mapping.clone()},e.prototype.setMapping=function(t){this.mapping.eq(t)||this.fire(["mappingChanged","dirtyValues","dirty"],this.mapping.clone(),this.mapping=t)},e.prototype.isFiltered=function(){return isFinite(this.currentFilter.min)||isFinite(this.currentFilter.max)},Object.defineProperty(e.prototype,"filterMin",{get:function(){return this.currentFilter.min},set:function(t){var e={min:this.currentFilter.min,max:this.currentFilter.max};this.currentFilter.min=isNaN(t)?-(1/0):t,this.fire(["filterChanged","dirtyValues","dirty"],e,this.currentFilter)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"filterMax",{get:function(){return this.currentFilter.max},set:function(t){var e={min:this.currentFilter.min,max:this.currentFilter.max};this.currentFilter.max=isNaN(t)?1/0:t,this.fire(["filterChanged","dirtyValues","dirty"],e,this.currentFilter)},enumerable:!0,configurable:!0}),e.prototype.getFilter=function(){return{min:this.currentFilter.min,max:this.currentFilter.max}},e.prototype.setFilter=function(t){if(void 0===t&&(t={min:-(1/0),max:+(1/0)}),this.currentFilter.min!==t.min||this.currentFilter.max!==t.max){var e=this.getFilter();this.currentFilter.min=isNaN(t.min)?-(1/0):t.min,this.currentFilter.max=isNaN(t.max)?1/0:t.max,this.fire(["filterChanged","dirtyValues","dirty"],e,this.currentFilter)}},e.prototype.filter=function(t){if(!this.isFiltered())return!0;var e=this.getRawValue(t);return!!isNaN(e)||!(isFinite(this.currentFilter.min)&&e<this.currentFilter.min||isFinite(this.currentFilter.max)&&e>this.currentFilter.max)},e}(C),E=function(t){function e(e,n){t.call(this,e,n),this.currentFilter=null,this._alignment="left",this.setWidthImpl(200),this._alignment=n.alignment||"left"}return v(e,t),Object.defineProperty(e.prototype,"alignment",{get:function(){return this._alignment},enumerable:!0,configurable:!0}),e.prototype.getValue=function(e){var n=t.prototype.getValue.call(this,e);return"undefined"==typeof n||null==n?"":String(n)},e.prototype.dump=function(e){var n=t.prototype.dump.call(this,e);return this.currentFilter instanceof RegExp?n.filter="REGEX:"+this.currentFilter.source:n.filter=this.currentFilter,n.alignment=this.alignment,n},e.prototype.restore=function(e,n){t.prototype.restore.call(this,e,n),e.filter&&"REGEX:"===e.filter.slice(0,6)?this.currentFilter=new RegExp(e.filter.slice(6)):this.currentFilter=e.filter||null,this._alignment=e.alignment||this._alignment},e.prototype.isFiltered=function(){return null!=this.currentFilter},e.prototype.filter=function(t){if(!this.isFiltered())return!0;var n=this.getLabel(t),r=this.currentFilter;return r===e.FILTER_MISSING?null!=n&&""!==n.trim():"string"==typeof r&&r.length>0?n&&n.toLowerCase().indexOf(r.toLowerCase())>=0:!(r instanceof RegExp)||n&&r.test(n)},e.prototype.getFilter=function(){return this.currentFilter},e.prototype.setFilter=function(t){""===t&&(t=null),this.currentFilter!==t&&this.fire(["filterChanged","dirtyValues","dirty"],this.currentFilter,this.currentFilter=t)},e.prototype.compare=function(t,e){var n,r;return""===(n=this.getValue(t))?""===this.getValue(e)?0:1:""===(r=this.getValue(e))?-1:n.localeCompare(r)},e.FILTER_MISSING="__FILTER_MISSING",e}(C),L=function(t){function e(e,n){t.call(this,e,n),this.link=null,this.link=n.link}return v(e,t),Object.defineProperty(e.prototype,"headerCssClass",{get:function(){return null==this.link?"link":"link link_pattern"},enumerable:!0,configurable:!0}),e.prototype.createEventList=function(){return t.prototype.createEventList.call(this).concat(["linkChanged"])},e.prototype.setLink=function(t){t!=this.link&&this.fire(["linkChanged","dirtyHeader","dirtyValues","dirty"],this.link,this.link=t)},e.prototype.getLink=function(){return this.link||""},e.prototype.dump=function(e){var n=t.prototype.dump.call(this,e);return this.link!=this.desc.link&&(n.link=this.link),n},e.prototype.restore=function(e,n){t.prototype.restore.call(this,e,n),e.link&&(this.link=e.link)},e.prototype.getLabel=function(e){var n=t.prototype.getValue.call(this,e);return n.alt?n.alt:""+n},e.prototype.isLink=function(e){if(this.link)return!0;var n=t.prototype.getValue.call(this,e);return null!=n.href},e.prototype.getValue=function(e){var n=t.prototype.getValue.call(this,e);return n.href?n.href:this.link?this.link.replace(/\$1/g,n):n},e}(E),S=function(t){function e(e,n){t.call(this,e,n),this.annotations=m.map()}return v(e,t),e.prototype.createEventList=function(){return t.prototype.createEventList.call(this).concat(["valueChanged"])},e.prototype.getValue=function(e){var n=String(e._index);return this.annotations.has(n)?this.annotations.get(n):t.prototype.getValue.call(this,e)},e.prototype.dump=function(e){var n=t.prototype.dump.call(this,e);return n.annotations={},this.annotations.forEach(function(t,e){n.annotations[t]=e}),n},e.prototype.restore=function(e,n){var r=this;t.prototype.restore.call(this,e,n),e.annotations&&Object.keys(e.annotations).forEach(function(t){r.annotations.set(t,e.annotations[t])})},e.prototype.setValue=function(t,e){var n=this.getValue(t);return n===e||(""===e||null==e?this.annotations.remove(String(t._index)):this.annotations.set(String(t._index),e),this.fire(["valueChanged","dirtyValues","dirty"],t._index,n,e),!0)},e}(E),R=function(t){function e(e,n){t.call(this,e,n),this.setCompressed(!0)}return v(e,t),e.desc=function(t){return void 0===t&&(t="S"),{type:"selection",label:t}},e.prototype.createEventList=function(){return t.prototype.createEventList.call(this).concat(["select"])},e.prototype.setValue=function(t,e){var n=this.getValue(t);return n===e||this.setImpl(t,e)},e.prototype.setImpl=function(t,e){return this.desc.setter&&this.desc.setter(t,e),this.fire("select",t,e),!0},e.prototype.toggleValue=function(t){var e=this.getValue(t);return this.setImpl(t,!e),!e},e.prototype.compare=function(t,e){return m.ascending(this.getValue(t),this.getValue(e))},e}(C),F=function(t){function e(e,n){t.call(this,e,n),this.currentFilter=null,this.trueMarker="X",this.falseMarker="",this.setWidthImpl(30),this.trueMarker=n.trueMarker||this.trueMarker,this.falseMarker=n.falseMarker||this.falseMarker}return v(e,t),e.prototype.getValue=function(e){var n=t.prototype.getValue.call(this,e);return"undefined"!=typeof n&&null!=n&&(n===!0||"true"===n||"yes"===n||"x"===n)},e.prototype.getLabel=function(t){var e=this.getValue(t);return e?this.trueMarker:this.falseMarker},e.prototype.dump=function(e){var n=t.prototype.dump.call(this,e);return null!==this.currentFilter&&(n.filter=this.currentFilter),n},e.prototype.restore=function(e,n){t.prototype.restore.call(this,e,n),"undefined"!=typeof e.filter&&(this.currentFilter=e.filter)},e.prototype.isFiltered=function(){return null!==this.currentFilter},e.prototype.filter=function(t){if(!this.isFiltered())return!0;var e=this.getValue(t);return e===this.currentFilter},e.prototype.getFilter=function(){return this.currentFilter},e.prototype.setFilter=function(t){this.currentFilter!==t&&this.fire(["filterChanged","dirtyValues","dirty"],this.currentFilter,this.currentFilter=t)},e.prototype.compare=function(t,e){return m.ascending(this.getValue(t),this.getValue(e))},e}(C),P=function(t){function e(e,n){t.call(this,e,n),this.colors=m.scale.category10(),this.catLabels=m.map(),this.currentFilter=null,this.separator=";",this.separator=n.separator||this.separator,this.initCategories(n)}return v(e,t),e.prototype.initCategories=function(t){if(t.categories){var e=[],n=this.colors.range(),r=m.map();t.categories.forEach(function(t,i){"string"==typeof t?e.push(t):(e.push(t.name||t.value),t.label&&r.set(t.name,t.label),t.color&&(n[i]=t.color))}),this.catLabels=r,this.colors.domain(e).range(n)}},Object.defineProperty(e.prototype,"categories",{get:function(){return this.colors.domain()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"categoryColors",{get:function(){return this.colors.range()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"categoryLabels",{get:function(){var t=this;return null===this.catLabels||this.catLabels.empty()?this.categories:this.categories.map(function(e){return t.catLabels.has(e)?t.catLabels.get(e):e})},enumerable:!0,configurable:!0}),e.prototype.colorOf=function(t){return this.colors(t)},e.prototype.getLabel=function(t){return null===this.catLabels||this.catLabels.empty()?""+E.prototype.getValue.call(this,t):this.getLabels(t).join(this.separator)},e.prototype.getFirstLabel=function(t){var e=this.getLabels(t);return e.length>0?e[0]:null},e.prototype.getLabels=function(t){var e=this,n=E.prototype.getValue.call(this,t),r=n?n.split(this.separator):[],i=function(t){return null===e.catLabels||e.catLabels.empty()?t:t.map(function(t){return e.catLabels.has(t)?e.catLabels.get(t):t})};return i(r)},e.prototype.getValue=function(t){var e=this.getValues(t);return e.length>0?e[0]:null},e.prototype.getValues=function(t){var e=E.prototype.getValue.call(this,t),n=e?e.split(this.separator):[];return n},e.prototype.getCategories=function(t){return this.getValues(t)},e.prototype.getColor=function(t){var e=this.getValue(t);return null===e||""===e?null:this.colors(e)},e.prototype.getColors=function(t){return this.getCategories(t).map(this.colors)},e.prototype.dump=function(e){var n=t.prototype.dump.call(this,e);return n.filter=this.currentFilter,n.colors={domain:this.colors.domain(),range:this.colors.range(),separator:this.separator},null===this.catLabels||this.catLabels.empty()||(n.labels=this.catLabels.entries()),n},e.prototype.restore=function(e,n){var r=this;t.prototype.restore.call(this,e,n),this.currentFilter=e.filter||null,e.colors&&this.colors.domain(e.colors.domain).range(e.colors.range),e.labels&&(this.catLabels=m.map(),e.labels.forEach(function(t){return r.catLabels.set(t.key,t.value)})),this.separator=e.separator||this.separator},e.prototype.isFiltered=function(){return null!=this.currentFilter},e.prototype.filter=function(t){if(!this.isFiltered())return!0;var e=this.getCategories(t),n=this.currentFilter;return e.every(function(t){return Array.isArray(n)&&n.length>0?n.indexOf(t)>=0:"string"==typeof n&&n.length>0?t&&t.toLowerCase().indexOf(n.toLowerCase())>=0:!(n instanceof RegExp)||null!=t&&t.match(n).length>0})},e.prototype.getFilter=function(){return this.currentFilter},e.prototype.setFilter=function(t){p(this.currentFilter,t)||this.fire(["filterChanged","dirtyValues","dirty"],this.currentFilter,this.currentFilter=t)},e.prototype.compare=function(t,e){for(var n=this.getValues(t),r=this.getValues(e),i=0;i<Math.min(n.length,r.length);++i){var o=m.ascending(n[i],r[i]);if(0!==o)return o}return n.length-r.length},e}(C),O=function(t){function e(e,n){if(t.call(this,e,n),this.colors=m.scale.category10(),this.catLabels=m.map(),this.scale=m.scale.ordinal().rangeRoundPoints([0,1]),this.currentFilter=null,this.separator=";",this.combiner=m.max,this.separator=n.separator||this.separator,P.prototype.initCategories.call(this,n),this.scale.domain(this.colors.domain()),n.categories){var r=n.categories.map(function(t){return"string"!=typeof t&&"number"==typeof t.value?t.value:.5});this.scale.range(r)}}return v(e,t),e.prototype.createEventList=function(){return t.prototype.createEventList.call(this).concat(["mappingChanged"])},Object.defineProperty(e.prototype,"categories",{get:function(){return this.colors.domain().slice()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"categoryColors",{get:function(){return this.colors.range().slice()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"categoryLabels",{get:function(){var t=this;return null===this.catLabels||this.catLabels.empty()?this.categories:this.categories.map(function(e){return t.catLabels.has(e)?t.catLabels.get(e):e})},enumerable:!0,configurable:!0}),e.prototype.colorOf=function(t){return this.colors(t)},e.prototype.getLabel=function(t){return P.prototype.getLabel.call(this,t)},e.prototype.getFirstLabel=function(t){return P.prototype.getFirstLabel.call(this,t)},e.prototype.getLabels=function(t){return P.prototype.getLabels.call(this,t)},e.prototype.getValue=function(t){var e=this.getValues(t);return e.length>0?this.combiner(e):0},e.prototype.getValues=function(t){var e=P.prototype.getValues.call(this,t);return e.map(this.scale)},e.prototype.getCategories=function(t){return P.prototype.getValues.call(this,t)},e.prototype.getNumber=function(t){return this.getValue(t)},e.prototype.getColor=function(t){var e=this.getValues(t),n=this.getColors(t);return this.combiner===m.max?n.slice(1).reduce(function(t,n,r){return e[r+1]>t.v?{c:n,v:e[r+1]}:t},{c:n[0],v:e[0]}).c:this.combiner===m.min?n.slice(1).reduce(function(t,n,r){return e[r+1]<t.v?{c:n,v:e[r+1]}:t},{c:n[0],v:e[0]}).c:n[0]||null},e.prototype.getColors=function(t){return P.prototype.getColors.call(this,t)},e.prototype.dump=function(t){var e=P.prototype.dump.call(this,t);return e.scale={domain:this.scale.domain(),range:this.scale.range(),separator:this.separator},e},e.prototype.restore=function(t,e){P.prototype.restore.call(this,t,e),t.scale&&this.scale.domain(t.scale.domain).range(t.scale.range),this.separator=t.separator||this.separator},e.prototype.getScale=function(){return{domain:this.scale.domain(),range:this.scale.range()}},e.prototype.getMapping=function(){return this.scale.range().slice()},e.prototype.setMapping=function(t){var e=this.getScale();this.scale.range(t),this.fire(["mappingChanged","dirtyValues","dirty"],e,this.getScale())},e.prototype.isFiltered=function(){return null!=this.currentFilter},e.prototype.filter=function(t){return P.prototype.filter.call(this,t)},e.prototype.getFilter=function(){return this.currentFilter},e.prototype.setFilter=function(t){this.currentFilter!==t&&this.fire(["filterChanged","dirtyValues","dirty"],this.currentFilter,this.currentFilter=t)},e.prototype.compare=function(t,e){return _.prototype.compare.call(this,t,e)},e}(C),V=function(t){function e(e,n){t.call(this,e,n),this._children=[]}return v(e,t),e.prototype.assignNewId=function(e){t.prototype.assignNewId.call(this,e),this._children.forEach(function(t){return t.assignNewId(e)})},Object.defineProperty(e.prototype,"children",{get:function(){return this._children.slice()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"length",{get:function(){return this._children.length},enumerable:!0,configurable:!0}),e.prototype.flatten=function(t,e,n,r){void 0===n&&(n=0),void 0===r&&(r=0);var i=null;if(0===n||n<=b.FLAT_ALL_COLUMNS){var o=this.getCompressed()?b.COMPRESSED_WIDTH:this.getWidth();if(t.push(i={col:this,offset:e,width:o}),0===n)return o}return this._children.forEach(function(i){(!i.isHidden()||n<=b.FLAT_ALL_COLUMNS)&&i.flatten(t,e,n-1,r)}),o},e.prototype.dump=function(e){var n=t.prototype.dump.call(this,e);return n.children=this._children.map(function(t){return t.dump(e);
}),n},e.prototype.restore=function(e,n){var r=this;e.children.map(function(t){var e=n(t);e&&r.push(e)}),t.prototype.restore.call(this,e,n)},e.prototype.insert=function(t,e){return this._children.splice(e,0,t),this.insertImpl(t,e)},e.prototype.insertImpl=function(t,e){return t.parent=this,this.forward(t,"dirtyHeader.combine","dirtyValues.combine","dirty.combine","filterChanged.combine"),this.fire(["addColumn","dirtyHeader","dirtyValues","dirty"],t,e),t},e.prototype.push=function(t){return this.insert(t,this._children.length)},e.prototype.at=function(t){return this._children[t]},e.prototype.indexOf=function(t){return this._children.indexOf(t)},e.prototype.insertAfter=function(t,e){var n=this.indexOf(e);return n<0?null:this.insert(t,n+1)},e.prototype.remove=function(t){var e=this._children.indexOf(t);return!(e<0)&&(this._children.splice(e,1),this.removeImpl(t))},e.prototype.removeImpl=function(t){return t.parent=null,this.unforward(t,"dirtyHeader.combine","dirtyValues.combine","dirty.combine","filterChanged.combine"),this.fire(["removeColumn","dirtyHeader","dirtyValues","dirty"],t),!0},e.prototype.getColor=function(t){return this.color},e.prototype.isFiltered=function(){return this._children.some(function(t){return t.isFiltered()})},e.prototype.filter=function(t){return this._children.every(function(e){return e.filter(t)})},e}(b),D=function(t){function e(e,n){t.call(this,e,n),this.missingValue=0,this.numberFormat=m.format(".3n"),n.numberFormat&&(this.numberFormat=m.format(n.numberFormat))}return v(e,t),e.prototype.dump=function(e){var n=t.prototype.dump.call(this,e);return n.missingValue=this.missingValue,n},e.prototype.restore=function(e,n){e.missingValue&&(this.missingValue=e.missingValue),e.numberFormat&&(this.numberFormat=m.format(e.numberFormat)),t.prototype.restore.call(this,e,n)},e.prototype.insert=function(e,n){return o(e)?t.prototype.insert.call(this,e,n):null},e.prototype.getLabel=function(t){var e=this.getValue(t);return""+("number"==typeof e?this.numberFormat(e):e)},e.prototype.getValue=function(t){var e=this.compute(t);return"undefined"==typeof e||null==e||isNaN(e)?this.missingValue:e},e.prototype.compute=function(t){return NaN},e.prototype.getNumber=function(t){return this.getValue(t)},e.prototype.compare=function(t,e){return i(this.getValue(t),this.getValue(e))},e}(V),A=function(t){function e(e,n){t.call(this,e,n),this.collapsed=!1;var r=this;this.adaptChange=function(t,e){r.adaptWidthChange(this.source,t,e)}}return v(e,t),e.desc=function(t){return void 0===t&&(t="Combined"),{type:"stack",label:t}},e.prototype.createEventList=function(){return t.prototype.createEventList.call(this).concat(["collapseChanged","weightsChanged"])},e.prototype.setCollapsed=function(t){this.collapsed!==t&&this.fire(["collapseChanged","dirtyHeader","dirtyValues","dirty"],this.collapsed,this.collapsed=t)},e.prototype.getCollapsed=function(){return this.collapsed},e.prototype.flatten=function(t,e,n,r){void 0===n&&(n=0),void 0===r&&(r=0);var i=null,o=n<=b.FLAT_ALL_COLUMNS?this._children:this._children.filter(function(t){return!t.isHidden()});if(0===n||n<=b.FLAT_ALL_COLUMNS){var a=this.getCompressed()?b.COMPRESSED_WIDTH:this.getWidth();if(this.collapsed||this.getCompressed()||(a+=(o.length-1)*r),t.push(i={col:this,offset:e,width:a}),0===n)return a}var s=e;return o.forEach(function(e){s+=e.flatten(t,s,n-1,r)+r}),i&&(i.width=s-e-r),s-e-r},e.prototype.dump=function(e){var n=t.prototype.dump.call(this,e);return n.collapsed=this.collapsed,n},e.prototype.restore=function(e,n){this.collapsed=e.collapsed===!0,t.prototype.restore.call(this,e,n)},e.prototype.insert=function(e,n,r){return void 0===r&&(r=NaN),isNaN(r)||e.setWidth(r/(1-r)*this.getWidth()),e.on("widthChanged.stack",this.adaptChange),t.prototype.setWidth.call(this,0===this.length?e.getWidth():this.getWidth()+e.getWidth()),t.prototype.insert.call(this,e,n)},e.prototype.push=function(t,e){return void 0===e&&(e=NaN),this.insert(t,this.length,e)},e.prototype.insertAfter=function(t,e,n){void 0===n&&(n=NaN);var r=this.indexOf(e);return r<0?null:this.insert(t,r+1,n)},e.prototype.adaptWidthChange=function(t,e,n){if(e!==n){var r=this.getWeights(),i=this.getWidth(),o=(n-e)/i,a=e/i,s=(1-a-o)/(1-a);this._children.forEach(function(e){e===t||e.setWidthImpl(e.getWidth()*s)}),this.fire(["weightsChanged","dirtyHeader","dirtyValues","dirty"],r,this.getWeights())}},e.prototype.getWeights=function(){var t=this.getWidth();return this._children.map(function(e){return e.getWidth()/t})},e.prototype.setWeights=function(t){var e,n=this.getWeights(),r=t.length-this.length;if(r<0)if(e=m.sum(t),e<=1)for(var i=0;i<-r;++i)t.push((1-e)*(1/-r));else if(e<=100)for(var i=0;i<-r;++i)t.push((100-e)*(1/-r));t=t.slice(0,this.length),e=m.sum(t)/this.getWidth(),t=t.map(function(t){return t/e}),this._children.forEach(function(e,n){e.setWidthImpl(t[n])}),this.fire(["weightsChanged","dirtyHeader","dirtyValues","dirty"],n,t)},e.prototype.removeImpl=function(e){return e.on("widthChanged.stack",null),t.prototype.setWidth.call(this,1===this.length?100:this.getWidth()-e.getWidth()),t.prototype.removeImpl.call(this,e)},e.prototype.setWidth=function(e){var n=e/this.getWidth();this._children.forEach(function(t){t.setWidthImpl(t.getWidth()*n)}),t.prototype.setWidth.call(this,e)},e.prototype.compute=function(t){var e=this.getWidth();return this._children.reduce(function(n,r){return n+r.getValue(t)*(r.getWidth()/e)},0)},e}(D),H=function(t){function e(e,n){t.call(this,e,n)}return v(e,t),e.desc=function(t){return void 0===t&&(t="Max"),{type:"max",label:t}},e.prototype.getColor=function(t){var e=this._children;if(0===e.length)return this.color;for(var n=0,r=e[0].getValue(t),i=1;i<e.length;++i){var o=e[i].getValue(t);o>r&&(n=i,r=o)}return e[n].color},e.prototype.compute=function(t){return m.max(this._children,function(e){return e.getValue(t)})},e}(D),N=function(t){function e(e,n){t.call(this,e,n)}return v(e,t),e.desc=function(t){return void 0===t&&(t="Min"),{type:"min",label:t}},e.prototype.getColor=function(t){var e=this._children;if(0===e.length)return this.color;for(var n=0,r=e[0].getValue(t),i=1;i<e.length;++i){var o=e[i].getValue(t);o<r&&(n=i,r=o)}return e[n].color},e.prototype.compute=function(t){return m.min(this._children,function(e){return e.getValue(t)})},e}(D),M=function(t){function e(e,n){t.call(this,e,n)}return v(e,t),e.desc=function(t){return void 0===t&&(t="Mean"),{type:"mean",label:t}},e.prototype.compute=function(t){return m.mean(this._children,function(e){return e.getValue(t)})},e}(D),T=function(t){function e(e,n){t.call(this,e,n),this.collapsed=!1;var r=this;this.adaptChange=function(t,e){r.adaptWidthChange(this.source,t,e)}}return v(e,t),e.prototype.createEventList=function(){return t.prototype.createEventList.call(this).concat(["collapseChanged"])},e.prototype.setCollapsed=function(t){this.collapsed!==t&&this.fire(["collapseChanged","dirtyHeader","dirtyValues","dirty"],this.collapsed,this.collapsed=t)},e.prototype.getCollapsed=function(){return this.collapsed},e.prototype.dump=function(e){var n=t.prototype.dump.call(this,e);return n.collapsed=this.collapsed,n},e.prototype.restore=function(e,n){this.collapsed=e.collapsed===!0,t.prototype.restore.call(this,e,n)},e.prototype.flatten=function(t,e,n,r){return void 0===n&&(n=0),void 0===r&&(r=0),A.prototype.flatten.call(this,t,e,n,r)},e.prototype.insert=function(e,n){return e.on("widthChanged.stack",this.adaptChange),t.prototype.setWidth.call(this,0===this.length?e.getWidth():this.getWidth()+e.getWidth()),t.prototype.insert.call(this,e,n)},e.prototype.adaptWidthChange=function(e,n,r){n!==r&&t.prototype.setWidth.call(this,this.getWidth()+(r-n))},e.prototype.removeImpl=function(e){return e.on("widthChanged.stack",null),t.prototype.setWidth.call(this,1===this.length?100:this.getWidth()-e.getWidth()),t.prototype.removeImpl.call(this,e)},e.prototype.setWidth=function(e){var n=this.length/this.getWidth();this._children.forEach(function(t){t.setWidthImpl(t.getWidth()*n)}),t.prototype.setWidth.call(this,e)},e}(V),W=function(t){function e(e,n){t.call(this,e,n)}return v(e,t),e.desc=function(t){return void 0===t&&(t="Nested"),{type:"nested",label:t}},e.prototype.compare=function(t,e){for(var n=this.children,r=0,i=n;r<i.length;r++){var o=i[r],a=o.compare(t,e);if(0!==a)return a}return 0},e.prototype.getLabel=function(t){return this.children.map(function(e){return e.getLabel(t)}).join(";")},e.prototype.getValue=function(t){return this.children.map(function(e){return e.getValue(t)}).join(";")},e}(T),I=function(t){function e(n,r){t.call(this,n,r),this.script=e.DEFAULT_SCRIPT,this.f=null,this.script=r.script||this.script}return v(e,t),e.desc=function(t){return void 0===t&&(t="script"),{type:"script",label:t,script:e.DEFAULT_SCRIPT}},e.prototype.createEventList=function(){return t.prototype.createEventList.call(this).concat(["scriptChanged"])},e.prototype.setScript=function(t){this.script!==t&&(this.f=null,this.fire(["scriptChanged","dirtyValues","dirty"],this.script,this.script=t))},e.prototype.getScript=function(){return this.script},e.prototype.dump=function(e){var n=t.prototype.dump.call(this,e);return n.script=this.script,n},e.prototype.restore=function(e,n){this.script=e.script||this.script,t.prototype.restore.call(this,e,n)},e.prototype.compute=function(t){return null==this.f&&(this.f=new Function("children","values",this.script)),this.f.call(this,this._children,this._children.map(function(e){return e.getValue(t)}))},e.DEFAULT_SCRIPT="return d3.max(values)",e}(V),j=function(t){function e(e,n){t.call(this,e,n),this.setWidthImpl(50)}return v(e,t),e.desc=function(t){return void 0===t&&(t="Rank"),{type:"rank",label:t}},e}(C),B=function(t){function e(e){var n=this;t.call(this),this.id=e,this.sortColumn=null,this.ascending=!1,this.columns=[],this.comparator=function(t,e){if(null===n.sortColumn)return 0;var r=n.sortColumn.compare(t,e);return n.ascending?r:-r},this.dirtyOrder=function(){n.fire(["dirtyOrder","dirtyValues","dirty"],n.getSortCriteria())},this.order=[],this.id=r(e)}return v(e,t),e.prototype.createEventList=function(){return t.prototype.createEventList.call(this).concat(["widthChanged","filterChanged","labelChanged","compressChanged","addColumn","removeColumn","dirty","dirtyHeader","dirtyValues","sortCriteriaChanged","dirtyOrder","orderChanged"])},e.prototype.assignNewId=function(t){this.id=r(t()),this.columns.forEach(function(e){return e.assignNewId(t)})},e.prototype.setOrder=function(t){this.fire(["orderChanged","dirtyValues","dirty"],this.order,this.order=t)},e.prototype.getOrder=function(){return this.order},e.prototype.dump=function(t){var e={};return e.columns=this.columns.map(function(e){return e.dump(t)}),e.sortColumn={asc:this.ascending},this.sortColumn&&(e.sortColumn.sortBy=this.sortColumn.id),e},e.prototype.restore=function(t,e){var n=this;if(this.clear(),t.columns.map(function(t){var r=e(t);r&&n.push(r)}),t.sortColumn&&(this.ascending=t.sortColumn.asc,t.sortColumn.sortBy)){var r=this.columns.filter(function(e){return e.id===t.sortColumn.sortBy});this.sortBy(0===r.length?null:r[0],t.sortColumn.asc)}},e.prototype.flatten=function(t,e,n,r){void 0===n&&(n=0),void 0===r&&(r=0);var i=e;return(n>0||n<=b.FLAT_ALL_COLUMNS)&&this.columns.forEach(function(e){(!e.isHidden()||n<=b.FLAT_ALL_COLUMNS)&&(i+=e.flatten(t,i,n-1,r)+r)}),i-e},e.prototype.getSortCriteria=function(){return{col:this.sortColumn,asc:this.ascending}},e.prototype.toggleSorting=function(t){return this.sortColumn===t?this.sortBy(t,!this.ascending):this.sortBy(t)},e.prototype.setSortCriteria=function(t){return this.sortBy(t.col,t.asc)},e.prototype.sortBy=function(t,e){if(void 0===e&&(e=!1),null!==t&&t.findMyRanker()!==this)return!1;if(this.sortColumn===t&&this.ascending===e)return!0;this.sortColumn&&this.sortColumn.on("dirtyValues.order",null);var n=this.getSortCriteria();return this.sortColumn=t,this.sortColumn&&this.sortColumn.on("dirtyValues.order",this.dirtyOrder),this.ascending=e,this.fire(["sortCriteriaChanged","dirtyOrder","dirtyHeader","dirtyValues","dirty"],n,this.getSortCriteria()),!0},Object.defineProperty(e.prototype,"children",{get:function(){return this.columns.slice()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"length",{get:function(){return this.columns.length},enumerable:!0,configurable:!0}),e.prototype.insert=function(t,e){return void 0===e&&(e=this.columns.length),this.columns.splice(e,0,t),t.parent=this,this.forward(t,"dirtyValues.ranking","dirtyHeader.ranking","dirty.ranking","filterChanged.ranking"),t.on("filterChanged.order",this.dirtyOrder),this.fire(["addColumn","dirtyHeader","dirtyValues","dirty"],t,e),null!==this.sortColumn||t instanceof j||t instanceof R||t instanceof x||this.sortBy(t,t instanceof E),t},Object.defineProperty(e.prototype,"fqpath",{get:function(){return""},enumerable:!0,configurable:!0}),e.prototype.findByPath=function(t){for(var e=this,n=t.split("@").map(Number).slice(1);n.length>0;){var r=n.shift();e=e.at(r)}return e},e.prototype.indexOf=function(t){return this.columns.indexOf(t)},e.prototype.at=function(t){return this.columns[t]},e.prototype.insertAfter=function(t,e){var n=this.columns.indexOf(e);return n<0?null:this.insert(t,n+1)},e.prototype.push=function(t){return this.insert(t)},e.prototype.remove=function(t){var e=this.columns.indexOf(t);if(e<0)return!1;if(this.unforward(t,"dirtyValues.ranking","dirtyHeader.ranking","dirty.ranking","filterChanged.ranking"),this.sortColumn===t){var n=this.columns.filter(function(e){return!(e===t||e instanceof R||e instanceof j)})[0];this.sortBy(n?n:null)}return t.parent=null,this.columns.splice(e,1),this.fire(["removeColumn","dirtyHeader","dirtyValues","dirty"],t,e),!0},e.prototype.clear=function(){var t=this;0!==this.columns.length&&(this.sortColumn=null,this.columns.forEach(function(e){t.unforward(e,"dirtyValues.ranking","dirtyHeader.ranking","dirty.ranking","filterChanged.ranking"),e.parent=null}),this.columns.length=0,this.fire(["removeColumn","dirtyHeader","dirtyValues","dirty"],null))},Object.defineProperty(e.prototype,"flatColumns",{get:function(){var t=[];return this.flatten(t,0,b.FLAT_ALL_COLUMNS),t.map(function(t){return t.col})},enumerable:!0,configurable:!0}),e.prototype.find=function(t){for(var e="string"==typeof t?function(e){return e.id===t}:t,n=this.flatColumns,r=0;r<n.length;++r)if(e(n[r]))return n[r];return null},e.prototype.toSortingDesc=function(t){var e=function(n){if(null===n)return null;if(n instanceof A){var r=n.getWeights();return n.children.map(function(t,n){return{weight:r[n],id:e(t)}})}return t(n.desc)},n=e(this.sortColumn);return null===n?null:{id:n,asc:this.ascending}},e.prototype.isFiltered=function(){return this.columns.some(function(t){return t.isFiltered()})},e.prototype.filter=function(t){return this.columns.every(function(e){return e.filter(t)})},e.prototype.findMyRanker=function(){return this},Object.defineProperty(e.prototype,"fqid",{get:function(){return this.id},enumerable:!0,configurable:!0}),e}(y.AEventDispatcher),z=A.desc,$=j.desc,U=R.desc,q=N.desc,Y=H.desc,X=M.desc,G=W.desc,K=I.desc},function(t,e,n){"use strict";function r(t){return t?new p(t):v}function i(t){return t?new f(t):b}function o(t,e,n){var r=this;void 0===n&&(n={}),n.selector=t,n.render=e,n.findRow=function(t,e){return t.selectAll(r.selector+'[data-index="'+e+'"]')};var i=new p(n);return i}function a(){return{string:new x,link:new C,number:i(),rank:r({textClass:"rank",align:"right"}),boolean:r({textClass:"boolean",align:"center"}),heatmap:new h,stack:new w,categorical:new k,ordinal:i({renderValue:!0,colorOf:function(t,e,n){return n.getColor(t)}}),max:_,min:_,mean:_,script:_,actions:new g,annotate:new y,selection:new m,nested:new w(!1)}}var s=n(2),l=n(0);n.n(l);n.d(e,"DefaultCellRenderer",function(){return u}),n.d(e,"BarCellRenderer",function(){return d}),n.d(e,"HeatMapCellRenderer",function(){return h}),n.d(e,"ActionCellRenderer",function(){return g}),n.d(e,"SelectionCellRenderer",function(){return m}),e.defaultRenderer=r,e.barRenderer=i,e.createRenderer=o,e.renderers=a;var c=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},u=function(){function t(){this.textClass="text",this.align="left"}return t.prototype.render=function(t,e,n,r){var i=t.datum(e).selectAll("text."+this.textClass).data(n,r.rowKey);i.enter().append("text").attr({class:this.textClass,"clip-path":"url(#"+r.idPrefix+"clipCol"+e.id+")",y:function(t,e){return r.cellPrevY(e)}});var o=2;"right"===this.align?o=e.getWidth()-5:"center"===this.align&&(o=.5*e.getWidth()),i.attr({x:function(t,e){return r.cellX(e)+o},"data-index":function(t,e){return e}}).text(function(t){return e.getLabel(t)}),r.animated(i).attr({y:function(t,e){return r.cellY(e)}}),i.exit().remove()},t.prototype.findRow=function(t,e){return t.selectAll("text."+this.textClass+'[data-index="'+e+'"]')},t.prototype.mouseEnter=function(t,e,n,r,i,o){var a=e.node(),s=this.findRow(t,i).node();s&&a.appendChild(s)},t.prototype.mouseLeave=function(t,e,n,r,i,o){var a=t.node(),s=e.node();s.hasChildNodes()&&a&&a.appendChild(s.firstChild),e.selectAll("*").remove()},t.prototype.renderCanvas=function(t,e,n,r){var i=this;t.save(),t.textAlign=this.align,n.forEach(function(n,o){var a=r.cellY(o),s=2;"right"===i.align?s=e.getWidth()-5:"center"===i.align&&(s=.5*e.getWidth());var l=r.cellX(o)+s;t.fillText(e.getLabel(n),l,a,e.getWidth())}),t.restore()},t.prototype.mouseEnterCanvas=function(t,e,n,r,i){},t}(),p=function(t){function e(e){var n=this;t.call(this),Object.keys(e).forEach(function(t){n[t]=e[t]})}return c(e,t),e}(u),d=function(t){function e(){t.apply(this,arguments),this.renderValue=!1}return c(e,t),e.prototype.render=function(t,e,n,r){var i=this,o=this.renderValue||r.option("renderBarValue",!1),a=t.datum(e).selectAll(".bar").data(n,r.rowKey),s=r.option("rowPadding",1),l=function(t,n,o){t.append("rect").attr({class:n,x:function(t,e){return r.cellX(e)},y:function(t,e){return r.cellPrevY(e)+s},width:function(t){var n=e.getWidth()*e.getValue(t);return isNaN(n)?0:n}}).style("fill",e.color),o.attr({height:function(t,e){return r.rowHeight(e)-2*r.option("rowPadding",1)}}),r.animated(o).attr({x:function(t,e){return r.cellX(e)},y:function(t,e){return r.cellY(e)+r.option("rowPadding",1)},width:function(t){var n=e.getWidth()*e.getValue(t);return isNaN(n)?0:n}}).style({fill:function(t,n){return i.colorOf(t,n,e)}})};if(o){var c=a.enter().append("g").attr("class","bar "+this.textClass);l(c,e.cssClass,a.select("rect")),c.append("text").attr({class:"number","clip-path":"url(#"+r.idPrefix+"clipCol"+e.id+")"}),r.animated(a.select("text").text(function(t){return e.getLabel(t)})).attr("transform",function(t,e){return"translate("+r.cellX(e)+","+r.cellY(e)+")"})}else l(a.enter(),"bar "+e.cssClass,a);a.attr({"data-index":function(t,e){return e}}),a.exit().remove()},e.prototype.colorOf=function(t,e,n){return n.color},e.prototype.findRow=function(t,e){return t.selectAll('.bar[data-index="'+e+'"]')},e.prototype.mouseEnter=function(e,n,r,i,o,a){var s=this.renderValue||a.option("renderBarValue",!1);if(s)return t.prototype.mouseEnter.call(this,e,n,r,i,o,a);var l=this.findRow(e,o);l.empty()||(n.node().appendChild(l.node()),n.append("text").datum(l.datum()).attr({class:"number","clip-path":"url(#"+a.idPrefix+"clipCol"+r.id+")",transform:"translate("+a.cellX(o)+","+a.cellY(o)+")"}).text(function(t){return r.getLabel(t)}))},e.prototype.renderCanvas=function(t,e,n,r){var i=this,o=this.renderValue||r.option("renderBarValue",!1),a=r.option("rowPadding",1);t.save(),n.forEach(function(n,l){var c=r.cellX(l),u=r.cellY(l)+a,p=e.getWidth()*e.getValue(n),d=isNaN(p)?0:p,h=r.rowHeight(l)-2*a;t.fillStyle=i.colorOf(n,l,e)||e.color||s.Column.DEFAULT_COLOR,t.fillRect(c,u,d,h),o&&t.fillText(e.getLabel(n),c,u-a,e.getWidth())}),t.restore()},e.prototype.mouseEnterCanvas=function(t,e,n,r,i){var o=this.renderValue||i.option("renderBarValue",!1);o||(t.save(),t.fillText(e.getLabel(n),i.cellX(r),i.cellY(r),e.getWidth()),t.restore())},e}(u),h=function(t){function e(){t.apply(this,arguments)}return c(e,t),e.prototype.render=function(t,e,n,r){var i=this,o=t.datum(e).selectAll("rect.heatmap").data(n,r.rowKey);o.enter().append("rect").attr({class:"bar "+e.cssClass,x:function(t,e){return r.cellX(e)},y:function(t,e){return r.cellPrevY(e)+r.option("rowPadding",1)},width:function(t,e){return r.rowHeight(e)-2*r.option("rowPadding",1)}}).style("fill",e.color),o.attr({"data-index":function(t,e){return e},width:function(t,e){return r.rowHeight(e)-2*r.option("rowPadding",1)},height:function(t,e){return r.rowHeight(e)-2*r.option("rowPadding",1)}}),r.animated(o).attr({x:function(t,e){return r.cellX(e)},y:function(t,e){return r.cellY(e)+r.option("rowPadding",1)}}).style({fill:function(t,n){return i.colorOf(t,n,e)}}),o.exit().remove()},e.prototype.colorOf=function(t,e,n){var r=n.getValue(t);isNaN(r)&&(r=0);var i=l.hsl(n.color||s.Column.DEFAULT_COLOR);return i.l=r,i.toString()},e.prototype.findRow=function(t,e){return t.selectAll('rect.heatmap[data-index="'+e+'"]')},e.prototype.mouseEnter=function(t,e,n,r,i,o){var a=this.findRow(t,i);a.empty()||(e.node().appendChild(a.node()),e.append("text").datum(a.datum()).attr({class:"number","clip-path":"url(#"+o.idPrefix+"clipCol"+n.id+")",transform:"translate("+o.cellX(i)+","+o.cellY(i)+")"}).text(function(t){return n.getLabel(t)}))},e.prototype.renderCanvas=function(t,e,n,r){var i=this;t.save(),n.forEach(function(n,o){var a=r.cellX(o),s=r.cellY(o)+r.option("rowPadding",1),l=r.rowHeight(o)-2*r.option("rowPadding",1);t.fillStyle=i.colorOf(n,o,e),t.fillRect(a,s,l,l)}),t.restore()},e.prototype.mouseEnterCanvas=function(t,e,n,r,i){t.save(),t.fillText(e.getLabel(n),i.cellX(r),i.cellY(r),e.getWidth()),t.restore()},e}(u),f=function(t){function e(e){var n=this;t.call(this),Object.keys(e).forEach(function(t){n[t]=e[t]})}return c(e,t),e}(d),g=function(){function t(){}return t.prototype.render=function(t,e,n,r){},t.prototype.mouseEnter=function(t,e,n,r,i,o){var a=o.option("actions",[]),s=e.append("text").attr({class:"actions fa",x:o.cellX(i),y:o.cellPrevY(i),"data-index":i}).selectAll("tspan").data(a);s.enter().append("tspan").text(function(t){return t.icon}).attr("title",function(t){return t.name}).on("click",function(t){l.event.preventDefault(),l.event.stopPropagation(),t.action(r)})},t.prototype.mouseLeave=function(t,e,n,r,i,o){e.selectAll("*").remove()},t}(),m=function(t){function e(){t.call(this),this.textClass="selection"}return c(e,t),e.prototype.render=function(t,e,n,r){var i=t.datum(e).selectAll("text."+this.textClass).data(n,r.rowKey);i.enter().append("text").attr({class:this.textClass+" fa",y:function(t,e){return r.cellPrevY(e)}}).on("click",function(t){l.event.preventDefault(),l.event.stopPropagation();var n=e.toggleValue(t);l.select(this).text(n===!0?"":"")}),i.attr({x:function(t,e){return r.cellX(e)},"data-index":function(t,e){return e}}).text(function(t){return e.getValue(t)===!0?"":""}),r.animated(i).attr({y:function(t,e){return r.cellY(e)}}),i.exit().remove()},e.prototype.renderCanvas=function(t,e,n,r){t.save(),t.font="FontAwesome",n.forEach(function(n,i){var o=r.cellX(i),a=r.cellY(i);t.fillText(e.getValue(n)===!0?"":"",o,a)}),t.restore()},e}(u),y=function(t){function e(){t.apply(this,arguments)}return c(e,t),e.prototype.mouseEnter=function(t,e,n,r,i,o){this.findRow(t,i).attr("display","none"),e.append("foreignObject").attr({x:o.cellX(i)-2,y:o.cellPrevY(i)-2,"data-index":i,width:n.getWidth(),height:o.rowHeight(i)}).append("xhtml:input").attr({type:"text",value:n.getValue(r)}).style({width:n.getWidth()+"px"}).on("change",function(){var t=this.value;n.setValue(r,t)}).on("click",function(){return l.event.stopPropagation()})},e.prototype.mouseLeave=function(t,e,n,r,i,o){this.findRow(t,i).attr("display",null);var a=e.select("input").node();a&&n.setValue(r,a.value),e.selectAll("*").remove()},e}(u),v=new u,b=new d,C=function(t){function e(){t.apply(this,arguments)}return c(e,t),e.prototype.render=function(t,e,n,r){var i=t.datum(e).selectAll("text.link").data(n,r.rowKey);i.enter().append("text").attr({class:"text link","clip-path":"url(#"+r.idPrefix+"clipCol"+e.id+")",y:function(t,e){return r.cellPrevY(e)}}),i.attr({x:function(t,e){return r.cellX(e)},"data-index":function(t,e){return e}}).html(function(t){return e.isLink(t)?'<a class="link" xlink:href="'+e.getValue(t)+'" target="_blank">'+e.getLabel(t)+"</a>":e.getLabel(t)}),r.animated(i).attr({y:function(t,e){return r.cellY(e)}}),i.exit().remove()},e.prototype.findRow=function(t,e){return t.selectAll('text.link[data-index="'+e+'"]')},e}(u),x=function(t){function e(){t.apply(this,arguments)}return c(e,t),e.prototype.render=function(e,n,r,i){return this.align=n.alignment,this.textClass="text"+("left"===n.alignment?"":"_"+n.alignment),t.prototype.render.call(this,e,n,r,i)},e}(u),k=function(t){function e(){t.apply(this,arguments),this.textClass="cat"}return c(e,t),e.prototype.render=function(t,e,n,r){var i=t.datum(e).selectAll("g."+this.textClass).data(n,r.rowKey),o=i.enter().append("g").attr({class:this.textClass,"data-index":function(t,e){return e},transform:function(t,e){return"translate("+r.cellX(e)+","+r.cellPrevY(e)+")"}});o.append("text").attr({"clip-path":"url(#"+r.idPrefix+"clipCol"+e.id+")",x:function(t,e){return r.rowHeight(e)}}),o.append("rect").attr({y:r.option("rowPadding",1)}),i.attr({"data-index":function(t,e){return e},transform:function(t,e){return"translate("+r.cellX(e)+","+r.cellY(e)+")"}}),i.select("text").attr({x:function(t,e){return r.rowHeight(e)}}).text(function(t){return e.getLabel(t)}),i.select("rect").style({fill:function(t){return e.getColor(t)}}).attr({height:function(t,e){return Math.max(r.rowHeight(e)-2*r.option("rowPadding",1),0)},width:function(t,e){return Math.max(r.rowHeight(e)-2*r.option("rowPadding",1),0)}}),r.animated(i).attr({transform:function(t,e){return"translate("+r.cellX(e)+","+r.cellY(e)+")"}}),i.exit().remove()},e.prototype.findRow=function(t,e){return t.selectAll("g."+this.textClass+'[data-index="'+e+'"]')},e.prototype.renderCanvas=function(t,e,n,r){t.save(),n.forEach(function(n,i){var o=r.cellX(i),a=r.cellY(i);t.fillStyle="black",t.fillText(e.getLabel(n),o+r.rowHeight(i),a),t.fillStyle=e.getColor(n),t.fillRect(o,a+r.option("rowPadding",1),Math.max(r.rowHeight(i)-2*r.option("rowPadding",1),0),Math.max(r.rowHeight(i)-2*r.option("rowPadding",1),0))})},e}(u),w=function(t){function e(e){void 0===e&&(e=!0),t.call(this),this.nestingPossible=e}return c(e,t),e.prototype.renderImpl=function(t,e,n,r,i,o){void 0===o&&(o=!0);var a=t.datum(e),s=e.children,c=this.nestingPossible&&n.showStacked(e),u=0,p=s.map(function(t){var e=u;return u+=t.getWidth(),u+=c?0:n.option("columnPadding",0),e}),d="component"+n.option("stackLevel",""),h=n.cellX,f=n.option;n.option=function(t,e){var n=f(t,e);return"stackLevel"===t?n+"N":n};var g=a.selectAll("g."+d).data(s,function(t){return t.id});g.enter().append("g").attr({class:d,transform:function(t,e){return"translate("+p[e]+",0)"}}),g.attr({class:function(t){return d+" "+t.desc.type},"data-stack":function(t,e){return e}}).each(function(t,e){if(c){var o=s.slice(0,e);n.cellX=function(t){return h(t)-o.reduce(function(e,n){return e+n.getWidth()*(1-n.getValue(i(t)))},0)}}r(l.select(this),t,e,n)}),(o?n.animated(g):g).attr({transform:function(t,e){return"translate("+p[e]+",0)"}}),g.exit().remove(),n.cellX=h,n.option=f},e.prototype.render=function(t,e,n,r){this.renderImpl(t,e,r,function(t,e,r,i){i.render(e,t,n,i)},function(t){return n[t]})},e.prototype.mouseEnter=function(t,e,n,r,i,o){var a="component"+o.option("stackLevel","");this.renderImpl(e,n,o,function(e,n,o,s){var l=t.select("g."+a+'[data-stack="'+o+'"]');l.empty()||s.renderer(n).mouseEnter(l,e,n,r,i,s)},function(t){return r},!1)},e.prototype.mouseLeave=function(t,e,n,r,i,o){var a="component"+o.option("stackLevel","");this.renderImpl(e,n,o,function(e,n,o,s){var l=t.select("g."+a+'[data-stack="'+o+'"]');l.empty()||s.renderer(n).mouseLeave(l,e,n,r,i,s)},function(t){return r},!1),e.selectAll("*").remove()},e.prototype.renderCanvas=function(t,e,n,r){var i=e.children,o=this.nestingPossible&&r.showStacked(e),a=0,s=i.map(function(t){var e=a;return a+=t.getWidth(),a+=o?0:r.option("columnPadding",0),e}),l=r.cellX,c=r.option;r.option=function(t,e){var n=c(t,e);return"stackLevel"===t?n+"N":n},t.save(),i.forEach(function(e,a){if(t.save(),t.translate(s[a],0),o){var c=i.slice(0,a);r.cellX=function(t){return l(t)-c.reduce(function(e,r){return e+r.getWidth()*(1-r.getValue(n[t]))},0)}}r.renderCanvas(e,t,n,r),t.restore()}),t.restore(),r.cellX=l,r.option=c},e}(u),_=i({colorOf:function(t,e,n){return n.getColor(t)}})},function(t,e,n){"use strict";function r(t,e,n){return void 0===n&&(n=!1),'<span style="font-weight: bold" class="lu-popup-title">'+t+'</span><form onsubmit="return false">'+e+'<button type = "submit" class="ok fa fa-check" title="ok"></button><button type = "reset" class="cancel fa fa-times" title="cancel"></button><button type = "button" class="reset fa fa-undo" title="reset"></button></form>'}function i(t,e,i){function o(){s.style({left:this.parentElement.offsetLeft+x.event.dx+"px",top:this.parentElement.offsetTop+x.event.dy+"px"})}var a=n.i(b.offset)(t.node()),s=x.select("body").append("div").attr({class:"lu-popup2"}).style({left:a.left+"px",top:a.top+"px"}).html(r(e,i));s.select("span.lu-popup-title").call(x.behavior.drag().on("drag",o)),s.on("keydown",function(){27===x.event.which&&s.remove()});var l=s.select("input[autofocus]").node();return l&&l.focus(),s}function o(t,e){var n=i(e,"Rename Column",'\n    <input type="text" size="15" value="'+t.label+'" required="required" autofocus="autofocus"><br>\n    <input type="color" size="15" value="'+t.color+'" required="required"><br>\n    <textarea rows="5">'+t.description+"</textarea><br>");n.select(".ok").on("click",function(){var e=n.select('input[type="text"]').property("value"),r=n.select('input[type="color"]').property("value"),i=n.select("textarea").property("value");t.setMetaData({label:e,color:r,description:i}),n.remove()}),n.select(".cancel").on("click",function(){n.remove()})}function a(t,e,n){void 0===n&&(n=[]);var r='<input type="text" size="15" value="'+t.getLink()+'" required="required" autofocus="autofocus" '+(n.length>0?'list="lineupPatternList"':"")+"><br>";n.length>0&&(r+='<datalist id="lineupPatternList">'+n.map(function(t){return'<option value="'+t+'">'})+"</datalist>");var o=i(e,"Edit Link ($ as Placeholder)",r);o.select(".ok").on("click",function(){var e=o.select('input[type="text"]').property("value");t.setLink(e),o.remove()}),o.select(".cancel").on("click",function(){o.remove()})}function s(t,e,n){function r(){var e=o.select('input[type="text"]').property("value"),r=o.select('input[type="text"]').property("checked");e.length>0&&(r&&(e=new RegExp(e)),n.searchSelect(e,t)),o.remove()}var o=i(e,"Search",'<input type="text" size="15" value="" required="required" autofocus="autofocus"><br><label><input type="checkbox">RegExp</label><br>');o.select('input[type="text"]').on("input",function(){var e=this.value;if(e.length>=3){var r=o.select('input[type="checkbox"]').property("checked");r&&(e=new RegExp(e)),n.searchSelect(e,t)}}),o.select('input[type="checkbox"]').on("change",r),o.select(".ok").on("click",r),o.select(".cancel").on("click",function(){o.remove()})}function l(t,e){function n(){l.select(".bar").transition().style("width",function(t){return a(t.weight)+"px"})}var r=t.getWeights(),o=t.children.map(function(t,e){return{col:t,weight:100*r[e]}}),a=x.scale.linear().domain([0,100]).range([0,120]),s=i(e,"Edit Weights","<table></table>"),l=s.select("table").selectAll("tr").data(o),c=l.enter().append("tr");c.append("td").append("input").attr({type:"number",value:function(t){return t.weight},min:0,max:100,size:5}).on("input",function(t){t.weight=+this.value,n()}),c.append("td").append("div").attr("class",function(t){return"bar "+t.col.cssClass}).style("background-color",function(t){return t.col.color}),c.append("td").text(function(t){return t.col.label;
}),n(),s.select(".cancel").on("click",function(){t.setWeights(r),s.remove()}),s.select(".reset").on("click",function(){o.forEach(function(t,e){return t.weight=100*r[e]}),l.select("input").property("value",function(t){return t.weight}),n()}),s.select(".ok").on("click",function(){t.setWeights(o.map(function(t){return t.weight})),s.remove()})}function c(t,e){void 0===e&&(e=!1),t.classed("filtered",e)}function u(t){return function(e,n){var r=e[t],i=n[t];return r.toLowerCase()<i.toLowerCase()?-1:r.toLowerCase()>i.toLowerCase()?1:0}}function p(t,e){function n(){h.select(".checkmark").html(function(t){return'<i class="fa fa-'+(t.isChecked?"check-":"")+'square-o"></i>'}),h.select(".datalabel").style("opacity",function(t){return t.isChecked?"1.0":".8"})}function r(){s.select(".selectAll").html(function(t){return'<i class="fa fa-'+(g?"check-":"")+'square-o"></i>'}),s.select("thead").on("click",function(t){g=!g,d.forEach(function(t){return t.isChecked=g}),n(),r()})}function o(n){c(e,n&&n.length>0&&n.length<d.length),t.setFilter(n)}var a=t.getFilter()||[],s=i(e,"Edit Filter",'<div class="selectionTable"><table><thead><th class="selectAll"></th><th>Category</th></thead><tbody></tbody></table></div>'),l=t.categoryColors,p=t.categoryLabels,d=t.categories.map(function(t,e){return{cat:t,label:p[e],isChecked:0===a.length||a.indexOf(t)>=0,color:l[e]}}).sort(u("label")),h=s.select("tbody").selectAll("tr").data(d),f=h.enter().append("tr");f.append("td").attr("class","checkmark"),f.append("td").attr("class","datalabel").text(function(t){return t.label}),f.on("click",function(t){t.isChecked=!t.isChecked,n()}),n();var g=!0;r(),s.select(".cancel").on("click",function(){o(a),s.remove()}),s.select(".reset").on("click",function(){d.forEach(function(t){return t.isChecked=!0}),n(),o(null)}),s.select(".ok").on("click",function(){var t=d.filter(function(t){return t.isChecked}).map(function(t){return t.cat});t.length===d.length&&(t=[]),o(t),s.remove()})}function d(t,e){function n(n){c(e,n&&""!==n),t.setFilter(n)}function r(t){var e=s.select('input[type="text"]').property("value"),r=s.select('input[type="checkbox"].lu_filter_missing').property("checked");if(r&&""===e&&(e=v.StringColumn.FILTER_MISSING),""===e)return void n(e);if(e.length>=3||t){var i=s.select('input[type="checkbox"]:first-of-type').property("checked");i&&e!==v.StringColumn.FILTER_MISSING&&(e=new RegExp(e)),n(e)}}var o=t.getFilter()||"",a=o===v.StringColumn.FILTER_MISSING;a&&(o="");var s=i(e,"Filter",'<input type="text" placeholder="containing..." autofocus="true" size="15" value="'+(o instanceof RegExp?o.source:o)+'" autofocus="autofocus">\n    <br><label><input type="checkbox" '+(o instanceof RegExp?'checked="checked"':"")+'>RegExp</label><br><label><input class="lu_filter_missing" type="checkbox" '+(a?'checked="checked"':"")+">Filter Missing</label>\n    <br>");s.selectAll('input[type="checkbox"]').on("change",r),s.select('input[type="text"]').on("input",r),s.select(".cancel").on("click",function(){s.select('input[type="text"]').property("value",o||""),s.select('input[type="checkbox"]:first-of-type').property("checked",o instanceof RegExp?"checked":null),s.select('input[type="checkbox"].lu_filter_missing').property("checked",a?"checked":null),n(o),s.remove()}),s.select(".reset").on("click",function(){s.select('input[type="text"]').property("value",""),s.selectAll('input[type="checkbox"]').property("checked",null),n(null)}),s.select(".ok").on("click",function(){r(!0),s.remove()})}function h(t,e){function n(n){c(e,null!==n),t.setFilter(n)}function r(t){var e=a.select('input[type="radio"][value="true"]').property("checked"),r=a.select('input[type="radio"][value="false"]').property("checked");n(!!e||!r&&null)}var o=t.getFilter(),a=i(e,"Filter",'<label><input type="radio" name="boolean_check" value="null" '+(null===o?'checked="checked"':"")+'>No Filter</label><br>\n     <label><input type="radio" name="boolean_check" value="true" '+(o===!0?'checked="checked"':"")+'>True</label><br>\n     <label><input type="radio" name="boolean_check" value="false" '+(o===!1?'checked="checked"':"")+">False</label>\n    <br>");a.selectAll('input[type="radio"]').on("change",r),a.select(".cancel").on("click",function(){n(o),a.remove()}),a.select(".reset").on("click",function(){var t=null===o?"null":String(o);a.selectAll('input[type="radio"]').property("checked",function(){return this.value===t}),n(null)}),a.select(".ok").on("click",function(){r(!0),a.remove()})}function f(t,e){function n(e){t.setScript(e)}function r(){var t=a.select("textarea").property("value");n(t)}var o=t.getScript(),a=i(e,"Edit Script",'Parameters: <code>values: number[], children: Column[]</code><br>\n      <textarea autofocus="true" rows="5" autofocus="autofocus" style="width: 95%;">'+t.getScript()+"</textarea><br>");a.select(".cancel").on("click",function(){a.select("textarea").property("value",o),n(o),a.remove()}),a.select(".reset").on("click",function(){a.select("textarea").property("value",v.ScriptColumn.DEFAULT_SCRIPT),n(v.ScriptColumn.DEFAULT_SCRIPT)}),a.select(".ok").on("click",function(){r(),a.remove()})}function g(t,e,i){function o(n,r){p=n,d=r,c(e,!n.eq(l)||u.min!==r.min||u.max!==r.min),t.setMapping(n),t.setFilter(r)}var a=n.i(b.offset)(e.node()),s=t.getMapping(),l=t.getOriginalMapping(),u=t.getFilter(),p=s.clone(),d=u,h=x.select("body").append("div").attr({class:"lu-popup"}).style({left:a.left+"px",top:a.top+"px"}).html(r("Change Mapping",'<div class="mappingArea"></div>')),f={callback:o,triggerCallback:"dragend"},g=i.mappingSample(t),m=new C.a(h.select(".mappingArea").node(),p,l,d,g,f);h.select(".ok").on("click",function(){o(m.scale,m.filter),h.remove()}),h.select(".cancel").on("click",function(){t.setMapping(s),c(e,!s.eq(l)),h.remove()}),h.select(".reset").on("click",function(){s=l,p=s.clone(),u={min:-(1/0),max:+(1/0)},d=u,o(p,d),h.selectAll(".mappingArea *").remove(),m=new C.a(h.select(".mappingArea").node(),p,l,d,g,f)})}function m(t,e){function n(){g.select(".checkmark").html(function(t){return'<i class="fa fa-'+(t.isChecked?"check-":"")+'square-o"></i>'}),g.select(".bar").transition().style("width",function(t){return s(t.range)+"px"}),g.select(".datalabel").style("opacity",function(t){return t.isChecked?"1.0":".8"})}function r(){l.select(".selectAll").html(function(t){return'<i class="fa fa-'+(y?"check-":"")+'square-o"></i>'}),l.select("thead").on("click",function(t){y=!y,f.forEach(function(t){return t.isChecked=y}),n(),r()})}function o(n){c(e,n&&n.length>0&&n.length<f.length),t.setFilter(n)}var a=t.getFilter()||[],s=x.scale.linear().domain([0,100]).range([0,120]),l=i(e,"Edit Categorical Mapping",'<div class="selectionTable"><table><thead><th class="selectAll"></th><th colspan="2">Scale</th><th>Category</th></thead><tbody></tbody></table></div>'),p=t.getScale().range,d=t.categoryColors,h=t.categoryLabels,f=t.categories.map(function(t,e){return{cat:t,label:h[e],isChecked:0===a.length||a.indexOf(t)>=0,range:100*p[e],color:d[e]}}).sort(u("label")),g=l.select("tbody").selectAll("tr").data(f),m=g.enter().append("tr");m.append("td").attr("class","checkmark").on("click",function(t){t.isChecked=!t.isChecked,n()}),m.append("td").append("input").attr({type:"number",value:function(t){return t.range},min:0,max:100,size:5}).on("input",function(t){t.range=+this.value,n()}),m.append("td").append("div").attr("class","bar").style("background-color",function(t){return t.color}),m.append("td").attr("class","datalabel").text(function(t){return t.label}),n();var y=!0;r(),l.select(".cancel").on("click",function(){o(a),t.setMapping(p),l.remove()}),l.select(".reset").on("click",function(){f.forEach(function(t){t.isChecked=!0,t.range=50}),n(),o(null),t.setMapping(f.map(function(){return 1}))}),l.select(".ok").on("click",function(){var e=f.filter(function(t){return t.isChecked}).map(function(t){return t.cat});e.length===f.length&&(e=[]),o(e),t.setMapping(f.map(function(t){return t.range/100})),l.remove()})}function y(){return{string:d,categorical:p,number:g,ordinal:m,boolean:h}}var v=n(2),b=n(1),C=n(8),x=n(0);n.n(x);e.dialogForm=r,e.makePopup=i,e.openRenameDialog=o,e.openEditLinkDialog=a,e.openSearchDialog=s,e.openEditWeightsDialog=l,e.openEditScriptDialog=f,e.filterDialogs=y},function(t,e,n){"use strict";function r(t,e,n){if(0===t.length)return{min:NaN,max:NaN,mean:NaN,count:0,maxBin:0,hist:[]};var r=l.layout.histogram().value(e);n&&r.range(function(){return n});var i=l.extent(t,e),o=r(t);return{min:i[0],max:i[1],mean:l.mean(t,e),count:t.length,maxBin:l.max(o,function(t){return t.y}),hist:o}}function i(t,e,n){var r=l.map();return n.forEach(function(t){return r.set(t,0)}),t.forEach(function(t){var n=e(t);null!=n&&n.forEach(function(t){r.set(t,(r.get(t)||0)+1)})}),{maxBin:l.max(r.values()),hist:r.entries().map(function(t){return{cat:t.key,y:t.value}})}}function o(t){return["rank","selection","actions"].indexOf(t.type)>=0}var a=n(2),s=n(1),l=n(0);n.n(l);n.d(e,"DataProvider",function(){return u}),n.d(e,"CommonDataProvider",function(){return p}),n.d(e,"LocalDataProvider",function(){return d}),n.d(e,"RemoteDataProvider",function(){return h});var c=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},u=function(t){function e(e){var r=this;void 0===e&&(e={}),t.call(this),this.rankings_=[],this.selection=l.set(),this.uid=0,this.columnTypes=n.i(s.merge)({},n.i(a.models)()),this.createHelper=function(t){var e=r.fromDescRef(t.desc),n=null;if(e&&e.type){r.fixDesc(t.desc);var i=r.columnTypes[e.type];n=new i(t.id,e),n.restore(t,r.createHelper)}return n},this.columnTypes=n.i(s.merge)(n.i(a.models)(),e.columnTypes||{})}return c(e,t),e.prototype.createEventList=function(){return t.prototype.createEventList.call(this).concat(["addColumn","removeColumn","addRanking","removeRanking","dirty","dirtyHeader","dirtyValues","orderChanged","selectionChanged"])},e.prototype.getColumns=function(){return[]},e.prototype.pushRanking=function(t){var e=this.cloneRanking(t);return this.insertRanking(e),e},e.prototype.takeSnapshot=function(t){var e=this.cloneRanking();return e.push(this.clone(t)),this.insertRanking(e),e},e.prototype.insertRanking=function(t,e){void 0===e&&(e=this.rankings_.length),this.rankings_.splice(e,0,t),this.forward(t,"addColumn.provider","removeColumn.provider","dirty.provider","dirtyHeader.provider","orderChanged.provider","dirtyValues.provider");var r=this;t.on("dirtyOrder.provider",n.i(s.delayedCall)(function(){r.triggerReorder(this.source)},100,null)),this.fire(["addRanking","dirtyHeader","dirtyValues","dirty"],t,e),this.triggerReorder(t)},e.prototype.triggerReorder=function(t){this.sort(t).then(function(e){return t.setOrder(e)})},e.prototype.removeRanking=function(t){var e=this.rankings_.indexOf(t);return!(e<0)&&(this.unforward(t,"addColumn.provider","removeColumn.provider","dirty.provider","dirtyHeader.provider","orderChanged.provider","dirtyOrder.provider","dirtyValues.provider"),this.rankings_.splice(e,1),t.on("dirtyOrder.provider",null),this.cleanUpRanking(t),this.fire(["removeRanking","dirtyHeader","dirtyValues","dirty"],t,e),!0)},e.prototype.clearRankings=function(){var t=this;this.rankings_.forEach(function(e){t.unforward(e,"addColumn.provider","removeColumn.provider","dirty.provider","dirtyHeader.provider","dirtyOrder.provider","dirtyValues.provider"),e.on("dirtyOrder.provider",null),t.cleanUpRanking(e)}),this.rankings_=[],this.fire(["removeRanking","dirtyHeader","dirtyValues","dirty"],null)},e.prototype.getRankings=function(){return this.rankings_.slice()},e.prototype.getLastRanking=function(){return this.rankings_[this.rankings_.length-1]},e.prototype.cleanUpRanking=function(t){},e.prototype.cloneRanking=function(t){return null},e.prototype.push=function(t,e){var n=this.create(e);return n?(t.push(n),n):null},e.prototype.insert=function(t,e,n){var r=this.create(n);return r?(t.insert(r,e),r):null},e.prototype.nextId=function(){return"col"+this.uid++},e.prototype.rankAccessor=function(t,e,n,r){return 0},e.prototype.fixDesc=function(t){var e=this;"rank"===t.type?t.accessor=this.rankAccessor.bind(this):"selection"===t.type&&(t.accessor=function(t){return e.isSelected(t._index)},t.setter=function(t,n){return n?e.select(t._index):e.deselect(t._index)})},e.prototype.create=function(t){this.fixDesc(t);var e=this.columnTypes[t.type];return e?new e(this.nextId(),t):null},e.prototype.clone=function(t){var e=this.dumpColumn(t);return this.restoreColumn(e)},e.prototype.restoreColumn=function(t){var e=this,n=function(t){var r=e.fromDescRef(t.desc),i=e.columnTypes[r.type];e.fixDesc(r);var o=new i("",r);return o.restore(t,n),o.assignNewId(e.nextId.bind(e)),o};return n(t)},e.prototype.find=function(t){for(var e="string"==typeof t?function(e){return e.id===t}:t,n=0;n<this.rankings_.length;++n){var r=this.rankings_[n].find(e);if(r)return r}return null},e.prototype.dump=function(){var t=this;return{uid:this.uid,selection:this.selection.values().map(Number),rankings:this.rankings_.map(function(e){return e.dump(t.toDescRef)})}},e.prototype.dumpColumn=function(t){return t.dump(this.toDescRef)},e.prototype.toDescRef=function(t){return t},e.prototype.fromDescRef=function(t){return t},e.prototype.restoreRanking=function(t){var e=this.cloneRanking();e.restore(t,this.createHelper),e.children.some(function(t){return t instanceof a.RankColumn})||e.insert(this.create(a.RankColumn.desc()),0);var n=this.nextId.bind(this);return e.children.forEach(function(t){return t.assignNewId(n)}),e},e.prototype.restore=function(t){var e=this;this.clearRankings(),this.uid=t.uid||0,t.selection&&t.selection.forEach(function(t){return e.selection.add(String(t))}),t.rankings&&t.rankings.forEach(function(t){var n=e.cloneRanking();n.restore(t,e.createHelper),n.children.some(function(t){return t instanceof a.RankColumn})||n.insert(e.create(a.RankColumn.desc()),0),e.insertRanking(n)}),t.layout&&Object.keys(t.layout).forEach(function(n){e.deriveRanking(t.layout[n])});var n=this.nextId.bind(this);this.rankings_.forEach(function(t){t.children.forEach(function(t){return t.assignNewId(n)})})},e.prototype.findDesc=function(t){return null},e.prototype.deriveDefault=function(){var t=this;if(!(this.rankings_.length>0)){var e=this.pushRanking();this.getColumns().forEach(function(n){o(n)||t.push(e,n)})}},e.prototype.deriveRanking=function(t){var e=this,r=this.cloneRanking();r.clear();var i=function(t){if("rank"===t.type)return e.create(n.i(a.createRankDesc)());if("selection"===t.type)return e.create(n.i(a.createSelectionDesc)());if("actions"===t.type){var r=e.create(n.i(a.createActionDesc)(t.label||"actions"));return r.restore(t,null),r}if("stacked"===t.type){var o=e.create(n.i(a.createStackDesc)(t.label||"Combined"));return(t.children||[]).forEach(function(t){var e=i(t);e&&o.push(e)}),o}var s=e.findDesc(t.column);if(s){var r=e.create(s);return t.label=t.label||s.label||s.column,r.restore(t,null),r}return null};return t.forEach(function(t){var e=i(t);e&&r.push(e)}),r.children.some(function(t){return t instanceof a.RankColumn})||r.insert(this.create(n.i(a.createRankDesc)()),0),this.insertRanking(r),r},e.prototype.sort=function(t){return Promise.reject("not implemented")},e.prototype.view=function(t){return Promise.reject("not implemented")},e.prototype.mappingSample=function(t){return Promise.reject("not implemented")},e.prototype.stats=function(t){return{stats:function(t){return Promise.reject("not implemented")},hist:function(t){return Promise.reject("not implemented")}}},e.prototype.rowKey=function(t,e){return"number"==typeof t?String(t):String(t._index)},e.prototype.isSelected=function(t){return this.selection.has(String(t))},e.prototype.select=function(t){this.selection.add(String(t)),this.fire("selectionChanged",this.selection.values().map(Number))},e.prototype.searchSelect=function(t,e){},e.prototype.selectAll=function(t,e){var n=this;void 0===e&&(e=!1),t.forEach(function(t){n.selection.add(String(t))}),this.fire("selectionChanged",this.selection.values().map(Number),e)},e.prototype.setSelection=function(t,e){var n=this;void 0===e&&(e=!1),this.selection.size()===t.length&&t.every(function(t){return n.selection.has(String(t))})||(this.selection=l.set(),this.selectAll(t,e))},e.prototype.toggleSelection=function(t,e){return void 0===e&&(e=!1),this.isSelected(t)?(e?this.deselect(t):this.clearSelection(),!1):(e?this.select(t):this.setSelection([t]),!0)},e.prototype.deselect=function(t){this.selection.remove(String(t)),this.fire("selectionChanged",this.selection.values().map(Number))},e.prototype.selectedRows=function(){return this.selection.empty()?Promise.resolve([]):this.view(this.getSelection())},e.prototype.getSelection=function(){var t=[];return this.selection.forEach(function(e){return t.push(+e)}),t.sort(),t},e.prototype.clearSelection=function(){this.selection=l.set(),this.fire("selectionChanged",[],!1)},e.prototype.exportTable=function(t,e){function r(t,e){return!i.quote||e&&n.i(a.isNumberColumn)(e)?t:i.quoteChar+t+i.quoteChar}void 0===e&&(e={});var i={separator:"\t",newline:"\n",header:!0,quote:!1,quoteChar:'"',filter:function(t){return!o(t)}};e=n.i(s.merge)(i,e);var l=t.flatColumns.filter(function(t){return i.filter(t.desc)});return this.view(t.getOrder()).then(function(t){var e=[];return i.header&&e.push(l.map(function(t){return r(t.label)}).join(i.separator)),t.forEach(function(t){e.push(l.map(function(e){return r(e.getLabel(t),e)}).join(i.separator))}),e.join(i.newline)})},e}(s.AEventDispatcher),p=function(t){function e(e,n){var r=this;void 0===e&&(e=[]),void 0===n&&(n={}),t.call(this,n),this.columns=e,this.rankingIndex=0,this.rowGetter=function(t,e,n){return t[n.column]},e.forEach(function(t){t.accessor=t.accessor||r.rowGetter,t.label=t.label||t.column})}return c(e,t),e.prototype.createEventList=function(){return t.prototype.createEventList.call(this).concat(["addDesc"])},e.prototype.pushDesc=function(t){var e=t;e.accessor=e.accessor||this.rowGetter,e.label=t.label||e.column,this.columns.push(t),this.fire("addDesc",e)},e.prototype.getColumns=function(){return this.columns.slice()},e.prototype.findDesc=function(t){return this.columns.filter(function(e){return e.column===t})[0]},e.prototype.toDescRef=function(t){return t.column?t.type+"@"+t.column:t},e.prototype.fromDescRef=function(t){return"string"==typeof t?this.columns.filter(function(e){return e.type+"@"+e.column===t})[0]:t},e.prototype.restore=function(e){t.prototype.restore.call(this,e),this.rankingIndex=1+l.max(this.getRankings(),function(t){return+t.id.substring(4)})},e.prototype.nextRankingId=function(){return"rank"+this.rankingIndex++},e}(u),d=function(t){function e(e,r,i){void 0===r&&(r=[]),void 0===i&&(i={}),t.call(this,r,i),this.data=e,this.options={filterGlobally:!1,jumpToSearchResult:!0},n.i(s.merge)(this.options,i),e.forEach(function(t,e){t._rankings={},t._index=e});var o=this;this.reorderall=function(){var t=this.source;o.getRankings().forEach(function(e){e!==t&&e.dirtyOrder()})}}return c(e,t),e.prototype.setData=function(t){t.forEach(function(t,e){t._rankings={},t._index=e}),this.data=t,this.reorderall()},e.prototype.clearData=function(){this.setData([])},e.prototype.appendData=function(t){var e=this.data.length;t.forEach(function(t,n){t._rankings={},t._index=e+n}),this.data.push.apply(this.data,t),this.reorderall()},e.prototype.rankAccessor=function(t,e,n,r){return t._rankings[r.id]+1||1},e.prototype.cloneRanking=function(t){var e=this,r=this.nextRankingId(),i=new a.Ranking(r);return t?(this.data.forEach(function(e){var n=e._rankings;n[r]=n[t.id]}),t.children.forEach(function(t){e.push(i,t.desc)})):i.push(this.create(n.i(a.createRankDesc)())),this.options.filterGlobally&&i.on("filterChanged.reorderall",this.reorderall),i},e.prototype.cleanUpRanking=function(t){this.options.filterGlobally&&t.on("filterChanged.reorderall",null),this.data.forEach(function(e){return delete e._rankings[t.id]})},e.prototype.sort=function(t){if(0===this.data.length)return Promise.resolve([]);var e=this.data.map(function(e,n){return{row:e,i:n,prev:e._rankings[t.id]||0}});if(this.options.filterGlobally){var n=this.getRankings().filter(function(t){return t.isFiltered()});n.length>0&&(e=e.filter(function(t){return n.every(function(e){return e.filter(t.row)})}))}else t.isFiltered()&&(e=e.filter(function(e){return t.filter(e.row)}));e.sort(function(e,n){return t.comparator(e.row,n.row)});var r=e.map(function(e,n){return e.row._rankings[t.id]=n,e.i});return Promise.resolve(r)},e.prototype.view=function(t){var e=this;if(0===this.data.length)return Promise.resolve([]);var n=this.data.length,r=t.filter(function(t){return t>=0&&t<n}).map(function(t){return e.data[t]});return Promise.resolve(r)},e.prototype.stats=function(t){var e=this,n=null,o=function(){return null===n?n=e.view(t):n};return{stats:function(t){return o().then(function(e){return r(e,t.getNumber.bind(t),[0,1])})},hist:function(t){return o().then(function(e){return i(e,t.getCategories.bind(t),t.categories)})}}},e.prototype.mappingSample=function(t){var e=this,n=500,r=this.data.length;if(r<=n)return Promise.resolve(this.data.map(t.getRawValue.bind(t)));for(var i=[],o=0;o<n;++o){for(var a=Math.floor(Math.random()*(r-1));i.indexOf(a)>=0;)a=Math.floor(Math.random()*(r-1));i.push(a)}return Promise.resolve(i.map(function(n){return t.getRawValue(e.data[n])}))},e.prototype.searchSelect=function(t,e){t="string"==typeof t?t.toLowerCase():t;var n="string"==typeof t?function(e){return e.toLowerCase().indexOf(t)>=0}:t.test.bind(t),r=this.data.filter(function(t){return n(e.getLabel(t))}).map(function(t){return t._index});this.setSelection(r,this.options.jumpToSearchResult)},e}(p),h=function(t){function e(e,n,r){void 0===n&&(n=[]),void 0===r&&(r={}),t.call(this,n,r),this.server=e,this.ranks={}}return c(e,t),e.prototype.rankAccessor=function(t,e,n,r){return this.ranks[r.id][t._index]||0},e.prototype.cloneRanking=function(t){var e=this.nextRankingId();t&&(this.ranks[e]=this.ranks[t.id]);var r=new a.Ranking(e);return r.push(this.create(n.i(a.createRankDesc)())),r},e.prototype.cleanUpRanking=function(t){delete this.ranks[t.id]},e.prototype.sort=function(t){var e=this,n=t.toSortingDesc(function(t){return t.column});return this.server.sort(n).then(function(n){return e.ranks[t.id]=n,n})},e.prototype.view=function(t){return this.server.view(t).then(function(e){return e.forEach(function(e,n){return e._index=t[n]}),e})},e.prototype.mappingSample=function(t){return this.server.mappingSample(t.desc.column)},e.prototype.searchSelect=function(t,e){var n=this;this.server.search(t,e.desc.column).then(function(t){n.setSelection(t)})},e}(p)},function(t,e,n){"use strict";function r(t){var e=t.label;return null!=t.description&&""!==t.description&&(e+="\n"+t.description),e}function i(){return null}var o=n(0),a=(n.n(o),n(1)),s=n(2),l=n(3),c=n(4);n.d(e,"PoolRenderer",function(){return d}),e.dummyRankingButtonHook=i,n.d(e,"HeaderRenderer",function(){return h}),n.d(e,"BodyRenderer",function(){return f}),n.d(e,"BodyCanvasRenderer",function(){return g});var u=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},p=function(){function t(t){this.desc=t,this.used=0}return t}(),d=function(){function t(t,e,r){void 0===r&&(r={}),this.data=t,this.options={layout:"vertical",elemWidth:100,elemHeight:40,width:100,height:500,additionalDesc:[],hideUsed:!0,addAtEndOnClick:!1},n.i(a.merge)(this.options,r),this.$node=o.select(e).append("div").classed("lu-pool",!0),this.changeDataStorage(t)}return t.prototype.changeDataStorage=function(t){var e=this;if(this.data&&this.data.on(["addColumn.pool","removeColumn.pool","addRanking.pool","removeRanking.pool","addDesc.pool"],null),this.data=t,this.entries=t.getColumns().concat(this.options.additionalDesc).map(function(t){return new p(t)}),t.on(["addDesc.pool"],function(t){e.entries.push(new p(t)),e.update()}),this.options.hideUsed){var n=this;t.on(["addColumn.pool","removeColumn.pool"],function(t){var e=t.desc,r="addColumn"===this.type?1:-1;n.entries.some(function(t){return t.desc===e&&(t.used+=r,!0)}),n.update()}),t.on(["addRanking.pool","removeRanking.pool"],function(t){var e=t.flatColumns.map(function(t){return t.desc}),r="addRanking"===this.type?1:-1;n.entries.some(function(t){return!(e.indexOf(t.desc)<0)&&(t.used+=r,!0)}),n.update()}),t.getRankings().forEach(function(t){var e=t.flatColumns.map(function(t){return t.desc}),r=1;n.entries.some(function(t){return!(e.indexOf(t.desc)<0)&&void(t.used+=r)})})}},t.prototype.remove=function(){this.$node.remove(),this.data&&this.data.on(["addColumn.pool","removeColumn.pool","addRanking.pool","removeRanking.pool","addDesc.pool"],null)},t.prototype.update=function(){var t=this,e=this.data,n=this.entries.filter(function(t){return 0===t.used}).map(function(t){return t.desc}),i=this.$node.selectAll("div.header").data(n),a=i.enter().append("div").attr({class:"header",draggable:!0}).on("dragstart",function(t){var n=o.event;n.dataTransfer.effectAllowed="copyMove",n.dataTransfer.setData("text/plain",t.label),n.dataTransfer.setData("application/caleydo-lineup-column",JSON.stringify(e.toDescRef(t))),s.isNumberColumn(t)&&n.dataTransfer.setData("application/caleydo-lineup-column-number",JSON.stringify(e.toDescRef(t)))}).style({width:this.options.elemWidth+"px",height:this.options.elemHeight+"px"});switch(this.options.addAtEndOnClick&&a.on("click",function(e){t.data.push(t.data.getLastRanking(),e)}),a.append("span").classed("label",!0).text(function(t){return t.label}),i.attr("class",function(t){return"header "+(t.cssClass||"")+" "+t.type}),i.style({transform:function(e,n){var r=t.layout(n);return"translate("+r.x+"px,"+r.y+"px)"},"background-color":function(t){var e=t;return e.cssClass?null:e.color||s.Column.DEFAULT_COLOR}}),i.attr({title:function(t){return r(t)}}),i.select("span").text(function(t){return t.label}),i.exit().remove(),this.options.layout){case"horizontal":this.$node.style({width:this.options.elemWidth*n.length+"px",height:1*this.options.elemHeight+"px"});break;case"grid":var l=o.round(this.options.width/this.options.elemWidth,0);this.$node.style({width:l*this.options.elemWidth+"px",height:Math.ceil(n.length/l)*this.options.elemHeight+"px"});break;default:this.$node.style({width:1*this.options.elemWidth+"px",height:this.options.elemHeight*n.length+"px"})}},t.prototype.layout=function(t){switch(this.options.layout){case"horizontal":return{x:t*this.options.elemWidth,y:0};case"grid":var e=o.round(this.options.width/this.options.elemWidth,0);return{x:t%e*this.options.elemWidth,y:Math.floor(t/e)*this.options.elemHeight};default:return{x:0,y:t*this.options.elemHeight}}},t}(),h=function(){function t(t,e,r){var l=this;void 0===r&&(r={}),this.data=t,this.options={slopeWidth:150,columnPadding:5,headerHistogramHeight:40,headerHeight:20,manipulative:!0,histograms:!1,filterDialogs:n.i(c.filterDialogs)(),linkTemplates:[],searchAble:function(t){return t instanceof s.StringColumn},sortOnLabel:!0,autoRotateLabels:!1,rotationHeight:50,rotationDegree:-20,freezeCols:0,rankingButtons:i},this.histCache=o.map(),this.dragHandler=o.behavior.drag().on("dragstart",function(){o.select(this).classed("dragging",!0),o.event.sourceEvent.stopPropagation(),o.event.sourceEvent.preventDefault()}).on("drag",function(t){var e=Math.max(o.mouse(this.parentNode)[0],2);t.setWidth(e),o.event.sourceEvent.stopPropagation(),o.event.sourceEvent.preventDefault()}).on("dragend",function(t){o.select(this).classed("dragging",!1),o.event.sourceEvent.stopPropagation(),o.event.sourceEvent.preventDefault()}),this.dropHandler=a.dropAble(["application/caleydo-lineup-column-ref","application/caleydo-lineup-column"],function(t,e,n){var r=null;if("application/caleydo-lineup-column-ref"in t){var i=t["application/caleydo-lineup-column-ref"];r=l.data.find(i),n?r=l.data.clone(r):r.removeMe()}else{var o=JSON.parse(t["application/caleydo-lineup-column"]);r=l.data.create(l.data.fromDescRef(o))}if(e instanceof s.Column)return null!=e.insertAfterMe(r);var a=l.data.getLastRanking();return null!==a.push(r)}),n.i(a.merge)(this.options,r),this.$node=o.select(e).append("div").classed("lu-header",!0),this.$node.append("div").classed("drop",!0).call(this.dropHandler),this.changeDataStorage(t)}return t.prototype.changeDataStorage=function(t){var e=this;this.data&&this.data.on(["dirtyHeader.headerRenderer","orderChanged.headerRenderer","selectionChanged.headerRenderer"],null),this.data=t,t.on("dirtyHeader.headerRenderer",a.delayedCall(this.update.bind(this),1)),this.options.histograms&&(t.on("orderChanged.headerRenderer",function(){e.updateHist(),e.update()}),t.on("selectionChanged.headerRenderer",a.delayedCall(this.drawSelection.bind(this),1)))},Object.defineProperty(t.prototype,"sharedHistCache",{get:function(){return this.histCache},enumerable:!0,configurable:!0}),t.prototype.currentHeight=function(){return parseInt(this.$node.style("height"),10)},t.prototype.updateHist=function(){var t=this,e=this.data.getRankings();e.forEach(function(e){var n=e.getOrder(),r=e.flatColumns,i=null==n?null:t.data.stats(n);r.filter(function(t){return t instanceof s.NumberColumn&&!t.isHidden()}).forEach(function(e){t.histCache.set(e.id,null===i?null:i.stats(e))}),r.filter(function(t){return s.isCategoricalColumn(t)&&!t.isHidden()}).forEach(function(e){t.histCache.set(e.id,null===i?null:i.hist(e))})})},t.prototype.drawSelection=function(){var t=this;if(this.options.histograms){var e=this.$node.node();[].slice.call(e.querySelectorAll("div.bar")).forEach(function(t){return t.classList.remove("selected")});var n=this.data.getSelection();n.length<=0||this.data.view(n).then(function(n){var r=t.data.getRankings();r.forEach(function(t){var r=t.flatColumns;r.filter(function(t){return t instanceof s.NumberColumn&&!t.isHidden()}).forEach(function(t){var r=[].slice.call(e.querySelectorAll('div.header[data-id="'+t.id+'"] div.bar'));n.forEach(function(e){for(var n=t.getValue(e),i=1;i<r.length;++i){var o=r[i];if(o.dataset.x>n){r[i-1].classList.add("selected");break}if(i===r.length-1){o.classList.add("selected");break}}})}),r.filter(function(t){return s.isCategoricalColumn(t)&&!t.isHidden()}).forEach(function(t){var r=e.querySelector('div.header[data-id="'+t.id+'"]');n.forEach(function(e){var n=t.getCategories(e);(n||[]).forEach(function(t){r.querySelector('div.bar[data-cat="'+t+'"]').classList.add("selected")})})})})})}},t.prototype.renderRankingButtons=function(t,e){var n=this.$node.selectAll("div.rankingbuttons").data(t);n.enter().append("div").classed("rankingbuttons",!0).call(this.options.rankingButtons),n.style("left",function(t,n){return e[n]+"px"}),n.exit().remove()},t.prototype.update=function(){function t(e){return!s.isMultiLevelColumn(e)||e.getCollapsed()||e.getCompressed()?1:1+Math.max.apply(Math,e.children.map(t))}var e=this,n=this,r=this.data.getRankings(),a=[],l=0,c=[];r.forEach(function(t){l+=t.flatten(a,l,1,e.options.columnPadding)+e.options.slopeWidth,c.push(l-e.options.slopeWidth)}),l-=this.options.slopeWidth;var u=a.map(function(t){return t.col});this.options.histograms&&this.histCache.empty()&&r.length>0&&this.updateHist(),this.renderColumns(u,a),this.options.rankingButtons!==i&&this.renderRankingButtons(r,c);var p=Math.max.apply(Math,u.map(t)),d=(this.options.histograms?this.options.headerHistogramHeight:this.options.headerHeight)+(p-1)*this.options.headerHeight;if(this.options.autoRotateLabels){var h=!1;this.$node.selectAll("div.header").style("height",d+"px").select("div.lu-label").each(function(t){var e=this.querySelector("span.lu-label").offsetWidth,r=t.getWidth();e>r+30?(o.select(this).style("transform","rotate("+n.options.rotationDegree+"deg)"),h=!0):o.select(this).style("transform",null)}),this.$node.selectAll("div.header").style("margin-top",h?this.options.rotationHeight+"px":null),d+=h?this.options.rotationHeight:0}this.$node.style("height",d+"px")},t.prototype.createToolbar=function(t){var e=this,r=this.options.filterDialogs,i=this.data,a=this,l=t.filter(function(t){
return!(t instanceof s.Ranking)}),u=t.filter(function(t){return t instanceof s.StackColumn}),p=t.filter(function(t){return s.isMultiLevelColumn(t)});u.append("i").attr("class","fa fa-tasks").attr("title","Edit Weights").on("click",function(t){n.i(c.openEditWeightsDialog)(t,o.select(this.parentNode.parentNode)),o.event.stopPropagation()}),l.append("i").attr("class","fa fa-pencil-square-o").attr("title","Rename").on("click",function(t){n.i(c.openRenameDialog)(t,o.select(this.parentNode.parentNode)),o.event.stopPropagation()}),l.append("i").attr("class","fa fa-code-fork").attr("title","Generate Snapshot").on("click",function(t){i.takeSnapshot(t),o.event.stopPropagation()}),t.filter(function(t){return t instanceof s.LinkColumn}).append("i").attr("class","fa fa-external-link").attr("title","Edit Link Pattern").on("click",function(t){n.i(c.openEditLinkDialog)(t,o.select(this.parentNode.parentNode),[].concat(t.desc.templates||[],a.options.linkTemplates)),o.event.stopPropagation()}),t.filter(function(t){return t instanceof s.ScriptColumn}).append("i").attr("class","fa fa-gears").attr("title","Edit Combine Script").on("click",function(t){n.i(c.openEditScriptDialog)(t,o.select(this.parentNode.parentNode)),o.event.stopPropagation()}),t.filter(function(t){return r.hasOwnProperty(t.desc.type)}).append("i").attr("class","fa fa-filter").attr("title","Filter").on("click",function(t){r[t.desc.type](t,o.select(this.parentNode.parentNode),i),o.event.stopPropagation()}),t.filter(function(t){return e.options.searchAble(t)}).append("i").attr("class","fa fa-search").attr("title","Search").on("click",function(t){n.i(c.openSearchDialog)(t,o.select(this.parentNode.parentNode),i),o.event.stopPropagation()}),l.append("i").attr("class","fa").classed("fa-toggle-left",function(t){return!t.getCompressed()}).classed("fa-toggle-right",function(t){return t.getCompressed()}).attr("title","(Un)Collapse").on("click",function(t){t.setCompressed(!t.getCompressed()),o.select(this).classed("fa-toggle-left",!t.getCompressed()).classed("fa-toggle-right",t.getCompressed()),o.event.stopPropagation()}),p.append("i").attr("class","fa").classed("fa-compress",function(t){return!t.getCollapsed()}).classed("fa-expand",function(t){return t.getCollapsed()}).attr("title","Compress/Expand").on("click",function(t){t.setCollapsed(!t.getCollapsed()),o.select(this).classed("fa-compress",!t.getCollapsed()).classed("fa-expand",t.getCollapsed()),o.event.stopPropagation()}),t.append("i").attr("class","fa fa-times").attr("title","Hide").on("click",function(t){t instanceof s.RankColumn?(i.removeRanking(t.findMyRanker()),0===i.getRankings().length&&i.pushRanking()):t.removeMe(),o.event.stopPropagation()})},t.prototype.updateFreeze=function(t){var e=this.options.freezeCols;this.$node.selectAll("div.header").style("z-index",function(t,n){return n<e?1:null}).style("transform",function(n,r){return r<e?"translate("+t+"px,0)":null})},t.prototype.renderColumns=function(t,e,n,i){var l=this;void 0===n&&(n=this.$node),void 0===i&&(i="header");var c=n.selectAll("div."+i).data(t,function(t){return t.id}),u=c.enter().append("div").attr({class:i}).on("click",function(t){var e=o.event;l.options.manipulative&&!e.defaultPrevented&&e.currentTarget===e.target&&t.toggleMySorting()}),p=u.append("div").classed("lu-label",!0).on("click",function(t){var e=o.event;l.options.manipulative&&!e.defaultPrevented&&t.toggleMySorting()}).on("dragstart",function(t){var e=o.event;e.dataTransfer.effectAllowed="copyMove",e.dataTransfer.setData("text/plain",t.label),e.dataTransfer.setData("application/caleydo-lineup-column-ref",t.id);var n=JSON.stringify(l.data.toDescRef(t.desc));e.dataTransfer.setData("application/caleydo-lineup-column",n),s.isNumberColumn(t)&&(e.dataTransfer.setData("application/caleydo-lineup-column-number",n),e.dataTransfer.setData("application/caleydo-lineup-column-number-ref",t.id))});p.append("i").attr("class","fa fa sort_indicator"),p.append("span").classed("lu-label",!0).attr({draggable:this.options.manipulative}),this.options.manipulative&&(u.append("div").classed("handle",!0).call(this.dragHandler).style("width",this.options.columnPadding+"px").call(this.dropHandler),u.append("div").classed("toolbar",!0).call(this.createToolbar.bind(this))),this.options.histograms&&u.append("div").classed("histogram",!0),c.style({width:function(t,n){return e[n].width+l.options.columnPadding+"px"},left:function(t,n){return e[n].offset+"px"},"background-color":function(t){return t.color}}),c.attr({class:function(t){return i+" "+(t.cssClass||"")+" "+(t.getCompressed()?"compressed":"")+" "+t.headerCssClass+" "+(l.options.autoRotateLabels?"rotateable":"")+" "+(t.isFiltered()?"filtered":"")},title:function(t){return r(t)},"data-id":function(t){return t.id}}),c.select("i.sort_indicator").attr("class",function(t){var e=t.findMyRanker();return e&&e.getSortCriteria().col===t?"sort_indicator fa fa-sort-"+(e.getSortCriteria().asc?"asc":"desc"):"sort_indicator fa"}),c.select("span.lu-label").text(function(t){return t.label});var d=this;c.filter(function(t){return s.isMultiLevelColumn(t)}).each(function(t){if(t.getCollapsed()||t.getCompressed())o.select(this).selectAll("div."+i+"_i").remove();else{var e=[];t.flatten(e,0,1,d.options.columnPadding);var n=e.map(function(t){return t.col});d.renderColumns(n,e,o.select(this),i+("_i"!==i.substr(i.length-2)?"_i":""))}}).select("div.lu-label").call(a.dropAble(["application/caleydo-lineup-column-number-ref","application/caleydo-lineup-column-number"],function(t,e,n){var r=null;if("application/caleydo-lineup-column-number-ref"in t){var i=t["application/caleydo-lineup-column-number-ref"];r=l.data.find(i),n?r=l.data.clone(r):r&&r.removeMe()}else{var o=JSON.parse(t["application/caleydo-lineup-column-number"]);r=l.data.create(l.data.fromDescRef(o))}return null!=e.push(r)})),this.options.histograms&&(c.filter(function(t){return s.isCategoricalColumn(t)}).each(function(t){var e=o.select(this).select("div.histogram"),n=d.histCache.get(t.id);n&&n.then(function(n){var r=e.selectAll("div.bar").data(n.hist);r.enter().append("div").classed("bar",!0);var i=o.scale.ordinal().domain(t.categories).rangeBands([0,100],.1),a=o.scale.linear().domain([0,n.maxBin]).range([0,100]);r.style({left:function(t){return i(t.cat)+"%"},width:function(t){return i.rangeBand()+"%"},top:function(t){return 100-a(t.y)+"%"},height:function(t){return a(t.y)+"%"},"background-color":function(e){return t.colorOf(e.cat)}}).attr({title:function(t){return t.cat+": "+t.y},"data-cat":function(t){return t.cat}}),r.exit().remove()})}),c.filter(function(t){return t instanceof s.NumberColumn}).each(function(t){var e=o.select(this).select("div.histogram"),n=d.histCache.get(t.id);n&&n.then(function(t){var n=e.selectAll("div.bar").data(t.hist);n.enter().append("div").classed("bar",!0);var r=o.scale.ordinal().domain(o.range(t.hist.length).map(String)).rangeBands([0,100],.1),i=o.scale.linear().domain([0,t.maxBin]).range([0,100]);n.style({left:function(t,e){return r(String(e))+"%"},width:function(t,e){return r.rangeBand()+"%"},top:function(t){return 100-i(t.y)+"%"},height:function(t){return i(t.y)+"%"}}).attr({title:function(t,e){return"Bin "+e+": "+t.y},"data-x":function(t){return t.x}}),n.exit().remove();var a=e.select("div.mean");a.empty()&&(a=e.append("div").classed("mean",!0)),a.style("left",100*t.mean+"%")})})),c.exit().remove()},t}(),f=function(t){function e(e,r,i,s){void 0===s&&(s={}),t.call(this),this.data=e,this.slicer=i,this.options={rowHeight:20,rowPadding:1,rowBarPadding:1,idPrefix:"",slopeWidth:150,columnPadding:5,stacked:!0,animation:!1,animationDuration:1e3,renderers:l.renderers(),meanLine:!1,actions:[],freezeCols:0},this.currentFreezeLeft=0,this.histCache=o.map(),n.i(a.merge)(this.options,s),this.$node=o.select(r).append("svg").classed("lu-body",!0),this.changeDataStorage(e)}return u(e,t),e.prototype.createEventList=function(){return t.prototype.createEventList.call(this).concat(["hoverChanged","renderFinished"])},Object.defineProperty(e.prototype,"node",{get:function(){return this.$node.node()},enumerable:!0,configurable:!0}),e.prototype.setOption=function(t,e){this.options[t]=e},e.prototype.changeDataStorage=function(t){var e=this;this.data&&this.data.on(["dirtyValues.bodyRenderer","selectionChanged.bodyRenderer"],null),this.data=t,t.on("dirtyValues.bodyRenderer",a.delayedCall(this.update.bind(this),1)),t.on("selectionChanged.bodyRenderer",a.delayedCall(function(t,n){n&&t.length>0&&e.jumpToSelection(),e.drawSelection()},1))},e.prototype.createContext=function(t){var e=this.options;return{rowKey:this.options.animation?this.data.rowKey:void 0,cellY:function(n){return(n+t)*e.rowHeight},cellPrevY:function(n){return(n+t)*e.rowHeight},cellX:function(t){return 0},rowHeight:function(t){return e.rowHeight*(1-e.rowPadding)},renderer:function(t){if(t.getCompressed()&&s.isNumberColumn(t))return e.renderers.heatmap;if(t instanceof s.StackColumn&&t.getCollapsed())return e.renderers.number;if(s.isMultiLevelColumn(t)&&t.getCollapsed())return e.renderers.string;var n=e.renderers[t.desc.type];return n||l.defaultRenderer()},render:function(t,e,n,r){void 0===r&&(r=this);var i=e.node(),o=i.__renderer__,a=this.renderer(t);o!==a&&(e.selectAll("*").remove(),i.__renderer__=a),a.render(e,t,n,r)},renderCanvas:function(t,e,n,r){void 0===r&&(r=this)},showStacked:function(t){return t instanceof s.StackColumn&&e.stacked},idPrefix:e.idPrefix,animated:function(t){return e.animation?t.transition().duration(e.animationDuration):t},showMeanLine:function(t){return e.meanLine&&s.isNumberColumn(t)&&!t.getCompressed()&&t.parent instanceof s.Ranking},option:function(t,n){return t in e?e[t]:n}}},e.prototype.updateClipPathsImpl=function(t,e,n){var r=this.$node.select("defs.body");r.empty()&&(r=this.$node.append("defs").classed("body",!0));var i=r.selectAll(function(){return this.getElementsByTagName("clipPath")}).data(t,function(t){return t.id});i.enter().append("clipPath").attr("id",function(t){return e.idPrefix+"clipCol"+t.id}).append("rect").attr({y:0}),i.exit().remove(),i.select("rect").attr({x:0,width:function(t){return Math.max(t.getWidth()-5,0)},height:n})},e.prototype.updateClipPaths=function(t,e,n){var r=this,i=[],o=0;t.forEach(function(t){var e=t.flatten(i,o,2,r.options.columnPadding);o+=e+r.options.slopeWidth}),this.updateClipPathsImpl(i.map(function(t){return t.col}),e,n);var a=this.$node.select("clipPath#c"+e.idPrefix+"Freeze");a.empty()&&(a=this.$node.append("clipPath").attr("id","c"+e.idPrefix+"Freeze").append("rect").attr({y:0,width:2e4,height:n})),a.select("rect").attr({height:n})},e.prototype.renderRankings=function(t,e,n,r,i,a){function s(t,e,n,a,s){t.classed("hover",!0);var l=t.select("g.values").selectAll("g.uchild").data(a.children.filter(function(t){return!t.isHidden()}),function(t){return t.id});l.enter().append("g").attr({class:"uchild"}).append("g").classed("child",!0),l.select("g.child").attr({transform:function(t,e){return"translate("+r[s].shifts[e]+",0)"}}).each(function(t,r){var a=this;p[s].then(function(s){i.renderer(t).mouseEnter(e.selectAll('g.child[data-index="'+r+'"]'),o.select(a),t,s[n],n,i)})}),l.exit().remove()}function l(t,e,n,r,a){t.classed("hover",!1),t.select("g.values").selectAll("g.uchild").each(function(t,r){var s=this;p[a].then(function(a){i.renderer(t).mouseLeave(e.selectAll('g.child[data-index="'+r+'"]'),o.select(s).select("g.child"),t,a[n],n,i)})}).remove()}var c=this,u=this,p=n.map(function(t){return c.data.view(t)}),d=t.selectAll("g.ranking").data(e,function(t){return t.id}),h=d.enter().append("g").attr({class:"ranking",transform:function(t,e){return"translate("+r[e].shift+",0)"}});h.append("g").attr("class","rows"),h.append("g").attr("class","cols"),i.animated(d).attr({transform:function(t,e){return"translate("+r[e].shift+",0)"}});var f=d.select("g.cols").selectAll("g.uchild").data(function(t){return t.children.filter(function(t){return!t.isHidden()})},function(t){return t.id});f.enter().append("g").attr("class","uchild").append("g").attr({class:"child",transform:function(t,e,n){return"translate("+r[n].shifts[e]+",0)"}}),f.exit().remove(),f=f.select("g.child"),f.attr({"data-index":function(t,e){return e}}),i.animated(f).attr({transform:function(t,e,n){return"translate("+r[n].shifts[e]+",0)"}}).each(function(t,e,n){var r=o.select(this);if(p[n].then(function(e){i.render(t,r,e,i)}),i.showMeanLine(t)){var s=u.histCache.get(t.id);s&&s.then(function(e){var n=r.selectAll("line.meanline").data([e.mean]);n.enter().append("line").attr("class","meanline"),n.exit().remove(),n.attr("x1",t.getWidth()*e.mean).attr("x2",t.getWidth()*e.mean).attr("y2",a)})}else r.selectAll("line.meanline").remove()}),Promise.all(p).then(function(t){c.fire("renderFinished")}),this.mouseOverItem=function(t,e){void 0===e&&(e=!0),d.each(function(n,r){var i=o.select(this),a=i.selectAll('g.row[data-index="'+t+'"]'),c=i.select("g.cols");if(!a.empty()){var u=a.datum().i;e?s(a,c,u,n,r):l(a,c,u,n,r)}}),u.updateFrozenRows()};var g=d.select("g.rows").selectAll("g.row").data(function(t,e){return n[e].map(function(t,e){return{d:t,i:e}})}),m=g.enter().append("g").attr({class:"row"});m.append("rect").attr({class:"bg"}),m.append("g").attr({class:"values"}),m.on("mouseenter",function(t){c.mouseOver(t.d,!0)}).on("mouseleave",function(t){c.mouseOver(t.d,!1)}).on("click",function(t){c.select(t.d,o.event.ctrlKey)}),g.attr({"data-index":function(t){return t.d}}).classed("selected",function(t){return c.data.isSelected(t.d)}),g.select("rect").attr({y:function(t){return i.cellY(t.i)},height:function(t){return i.rowHeight(t.i)},width:function(t,e,n){return r[n].width},class:function(t,e){return"bg "+(e%2===0?"even":"odd")}}),g.exit().remove(),d.exit().remove()},e.prototype.jumpToSelection=function(){var t=this,e=this.data.getSelection(),n=this.data.getRankings();if(!(e.length<=0||n.length<=0)){var r=n[0].getOrder(),i=this.slicer(0,r.length,function(e){return e*t.options.rowHeight}),o=r.slice(i.from,i.to);e.some(function(t){return o.indexOf(t)>=0})}},e.prototype.select=function(t,e){void 0===e&&(e=!1);var n=this.data.toggleSelection(t,e);this.$node.selectAll('g.row[data-index="'+t+'"], line.slope[data-index="'+t+'"]').classed("selected",n)},e.prototype.hasAnySelectionColumn=function(){return this.data.getRankings().some(function(t){return t.children.some(function(t){return t instanceof s.SelectionColumn&&!t.isHidden()})})},e.prototype.drawSelection=function(){this.hasAnySelectionColumn()&&this.update();var t=this.data.getSelection();if(0===t.length)this.$node.selectAll("g.row.selected, line.slope.selected").classed("selected",!1);else{var e=o.set(t);this.$node.selectAll("g.row").classed("selected",function(t){return e.has(String(t.d))}),this.$node.selectAll("line.slope").classed("selected",function(t){return e.has(String(t.data_index))})}},e.prototype.mouseOver=function(t,e){void 0===e&&(e=!0),this.fire("hoverChanged",e?t:-1),this.mouseOverItem(t,e),this.$node.selectAll('line.slope[data-index="'+t+'"]').classed("hover",e)},e.prototype.renderSlopeGraphs=function(t,e,n,r,i){var o=this,a=n.slice(1).map(function(t,e){return{left:n[e],left_i:e,right:t,right_i:e+1}}),s=t.selectAll("g.slopegraph").data(a);s.enter().append("g").attr({class:"slopegraph"}),s.attr({transform:function(t,e){return"translate("+(r[e+1].shift-o.options.slopeWidth)+",0)"}});var l=s.selectAll("line.slope").data(function(t,e){var n={};return t.right.forEach(function(t,e){n[t]=e}),t.left.map(function(t,e){return{data_index:t,lpos:e,rpos:n[t]}}).filter(function(t){return null!=t.rpos})});l.enter().append("line").attr({class:"slope",x2:this.options.slopeWidth}).on("mouseenter",function(t){o.mouseOver(t.data_index,!0)}).on("mouseleave",function(t){o.mouseOver(t.data_index,!1)}),l.attr({"data-index":function(t){return t.data_index}}),l.attr({y1:function(t){return.5*i.rowHeight(t.lpos)+i.cellY(t.lpos)},y2:function(t){return.5*i.rowHeight(t.rpos)+i.cellY(t.rpos)}}),l.exit().remove(),s.exit().remove()},e.prototype.updateFreeze=function(t){var e=this,n=this.options.freezeCols,r=this.$node.select("g.cols"),i=this.$node.select("#c"+this.options.idPrefix+"Freeze").select("rect"),a=r.select('g.child[data-index="'+n+'"]');a.empty()&&(a=r.select("g.child:last-of-type"));var s=o.transform(a.attr("transform")||"").translate[0];i.attr("x",t+s),r.selectAll("g.uchild").attr({"clip-path":function(t,r){return r<n?null:"url(#c"+e.options.idPrefix+"Freeze)"},transform:function(e,r){return r<n?"translate("+t+",0)":null}}),this.currentFreezeLeft=t,this.updateFrozenRows()},e.prototype.updateFrozenRows=function(){var t=this,e=this.options.freezeCols;if(!(e<=0)){var n=this.currentFreezeLeft,r=this.$node.select("g.rows");r.select("g.row.hover g.values").selectAll("g.uchild").attr({"clip-path":function(n,r){return r<e?null:"url(#c"+t.options.idPrefix+"Freeze)"},transform:function(t,r){return r<e?"translate("+n+",0)":null}})}},e.prototype.update=function(){var t=this,e=this.data.getRankings(),n=o.max(e,function(t){return t.getOrder().length})||0,r=this.options.rowHeight*n,i=this.slicer(0,n,function(e){return e*t.options.rowHeight}),a=function(t){return 0===i.from&&t.length<=i.to?t:t.slice(i.from,Math.min(t.length,i.to))},l=e.map(function(t){return a(t.getOrder())}),c=this.createContext(i.from),u=0,p=e.map(function(e,n){var r=u;u+=t.options.slopeWidth;var i=0,o=e.children.filter(function(t){return!t.isHidden()}).map(function(e){var n=i;return i+=(e.getCompressed()?s.Column.COMPRESSED_WIDTH:e.getWidth())+t.options.columnPadding,!s.isMultiLevelColumn(e)||e.getCollapsed()||e.getCompressed()||(i+=t.options.columnPadding*(e.length-1)),n});return u+=i,{shift:r,shifts:o,width:i}});this.$node.attr({width:Math.max(0,u-this.options.slopeWidth),height:r}),this.updateClipPaths(e,c,r);var d=this.$node.select("g.body");d.empty()&&(d=this.$node.append("g").classed("body",!0)),this.renderRankings(d,e,l,p,c,r),this.renderSlopeGraphs(d,e,l,p,c)},e}(a.AEventDispatcher),g=function(t){function e(e,r,i,s){void 0===s&&(s={}),t.call(this),this.data=e,this.slicer=i,this.options={rowHeight:20,rowPadding:1,rowBarPadding:1,idPrefix:"",slopeWidth:150,columnPadding:5,stacked:!0,renderers:l.renderers(),meanLine:!1,freezeCols:0},this.histCache=o.map(),n.i(a.merge)(this.options,s),this.$node=o.select(r).append("canvas").classed("lu-canvas.body",!0),this.changeDataStorage(e)}return u(e,t),e.prototype.createEventList=function(){return t.prototype.createEventList.call(this).concat(["hoverChanged"])},Object.defineProperty(e.prototype,"node",{get:function(){return this.$node.node()},enumerable:!0,configurable:!0}),e.prototype.setOption=function(t,e){this.options[t]=e},e.prototype.updateFreeze=function(t){},e.prototype.select=function(t,e){void 0===e&&(e=!1)},e.prototype.changeDataStorage=function(t){this.data&&this.data.on(["dirtyValues.bodyRenderer","selectionChanged.bodyRenderer"],null),this.data=t,t.on("dirtyValues.bodyRenderer",a.delayedCall(this.update.bind(this),1))},e.prototype.createContext=function(t){var e=this.options;return{rowKey:void 0,cellY:function(n){return(n+t)*e.rowHeight},cellPrevY:function(n){return(n+t)*e.rowHeight},cellX:function(t){return 0},rowHeight:function(t){return e.rowHeight*(1-e.rowPadding)},renderer:function(t){if(t.getCompressed()&&s.isNumberColumn(t))return e.renderers.heatmap;if(t instanceof s.StackColumn&&t.getCollapsed())return e.renderers.number;if(s.isMultiLevelColumn(t)&&t.getCollapsed())return e.renderers.string;var n=e.renderers[t.desc.type];return n||l.defaultRenderer()},render:function(t,e,n,r){void 0===r&&(r=this)},renderCanvas:function(t,e,n,r){void 0===r&&(r=this);var i=this.renderer(t);i.renderCanvas(e,t,n,r)},showStacked:function(t){return t instanceof s.StackColumn&&e.stacked},idPrefix:e.idPrefix,animated:function(t){return t},showMeanLine:function(t){return e.meanLine&&s.isNumberColumn(t)&&!t.getCompressed()&&t.parent instanceof s.Ranking},option:function(t,n){return t in e?e[t]:n}}},e.prototype.renderRankings=function(t,e,n,r,i,o){var a=this,s=n.map(function(t){return a.data.view(t)});t.save(),e.forEach(function(e,o){s[o].then(function(a){t.save(),t.translate(r[o].shift,0),t.save(),t.fillStyle="#f7f7f7",n[o].forEach(function(e,n){n%2===0&&t.fillRect(0,i.cellY(n),r[o].width,i.rowHeight(n))}),t.restore(),e.children.forEach(function(e,n){t.save(),t.translate(r[o].shifts[n],0),i.renderCanvas(e,t,a,i),t.restore()}),t.restore()})}),t.restore()},e.prototype.renderSlopeGraphs=function(t,e,n,r,i){var o=this,a=n.slice(1).map(function(t,e){return{left:n[e],left_i:e,right:t,right_i:e+1}});t.save(),t.fillStyle="darkgray",a.forEach(function(e,n){t.save(),t.translate(r[n+1].shift-o.options.slopeWidth,0);var a={};e.right.forEach(function(t,e){a[t]=e});var s=e.left.map(function(t,e){return{data_index:t,lpos:e,rpos:a[t]}}).filter(function(t){return null!=t.rpos});t.beginPath(),s.forEach(function(e){t.moveTo(0,.5*i.rowHeight(e.lpos)+i.cellY(e.lpos)),t.lineTo(o.options.slopeWidth,.5*i.rowHeight(e.rpos)+i.cellY(e.rpos))}),t.stroke(),t.restore()}),t.restore()},e.prototype.update=function(){var t=this,e=this.data.getRankings(),n=o.max(e,function(t){return t.getOrder().length})||0,r=this.options.rowHeight*n,i=this.slicer(0,n,function(e){return e*t.options.rowHeight}),a=function(t){return 0===i.from&&t.length<=i.to?t:t.slice(i.from,Math.min(t.length,i.to))},l=e.map(function(t){return a(t.getOrder())}),c=this.createContext(i.from),u=0,p=e.map(function(e,n){var r=u;u+=t.options.slopeWidth;var i=0,o=e.children.filter(function(t){return!t.isHidden()}).map(function(e){var n=i;return i+=(e.getCompressed()?s.Column.COMPRESSED_WIDTH:e.getWidth())+t.options.columnPadding,e instanceof s.StackColumn&&!e.getCollapsed()&&!e.getCompressed()&&(i+=t.options.columnPadding*(e.length-1)),n});return u+=i,{shift:r,shifts:o,width:i}});this.$node.attr({width:u,height:r});var d=this.$node.node().getContext("2d");d.font="10pt Times New Roman",d.textBaseline="top",d.clearRect(0,0,d.canvas.width,d.canvas.height),this.renderRankings(d,e,l,p,c,r),this.renderSlopeGraphs(d,e,l,p,c)},e}(a.AEventDispatcher)},function(t,e){},function(t,e,n){"use strict";function r(t,e,n){return Math.max(Math.min(t,n),e)}var i=n(0),o=(n.n(i),n(1)),a=n(2),s=function(){function t(t,e,r,a,s,l){void 0===l&&(l={}),this.parent=t,this.scale_=e,this.original=r,this.old_filter=a,this.dataPromise=s,this.options={width:370,height:225,padding_hor:7,padding_ver:7,filter_height:20,radius:5,callback:function(t){return t},callbackThisArg:null,triggerCallback:"change"},n.i(o.merge)(this.options,l),this.scale_=e.clone(),this.build(i.select(t))}return Object.defineProperty(t.prototype,"scale",{get:function(){return this.scale_},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"filter",{get:function(){return this.computeFilter()},enumerable:!0,configurable:!0}),t.prototype.build=function(t){function e(){m.attr({x1:function(t){return g(p.scale.apply(t))},x2:f}).style("visibility",function(t){var e=p.scale.domain;return t<e[0]||t>e[e.length-1]?"hidden":null})}function n(t){return i.behavior.drag().on("dragstart",function(){i.select(this).classed("dragging",!0).attr("r",1.1*u.radius)}).on("drag",t).on("dragend",function(){i.select(this).classed("dragging",!1).attr("r",u.radius),l(!0)})}function o(){function s(){y.sort(function(t,e){return t.r-e.r});var t=p.scale;t.domain=y.map(function(t){return t.r}),t.range=y.map(function(t){return t.n}),e()}function l(t){y.length<=2||(y.splice(t,1),s(),o())}function c(t){t=r(t,0,d),y.push({n:g.invert(t),r:f.invert(t)}),s(),o()}if(p.scale instanceof a.ScaleMappingFunction){var m=p.scale,v=m.domain,b=m.range;y=v.map(function(t,e){return{r:t,n:b[e]}}),t.selectAll("rect.adder").on("click",function(){c(i.mouse(t.select("svg > g").node())[0])});var C=t.select("g.mappings").selectAll("g.mapping").data(y),x=C.enter().append("g").classed("mapping",!0).on("contextmenu",function(t,e){i.event.preventDefault(),i.event.stopPropagation(),l(e)});x.append("line").attr({y1:0,y2:h}).call(n(function(t){var e=i.event.dx,n=r(g(t.n)+e,0,d),o=r(f(t.r)+e,0,d);t.n=g.invert(n),t.r=f.invert(o),i.select(this).attr("x1",n).attr("x2",o),i.select(this.parentElement).select("circle.normalized").attr("cx",n),i.select(this.parentElement).select("circle.raw").attr("cx",o),s()})),x.append("circle").classed("normalized",!0).attr("r",u.radius).call(n(function(t){var e=r(i.event.x,0,d);t.n=g.invert(e),i.select(this).attr("cx",e),i.select(this.parentElement).select("line").attr("x1",e),s()})),x.append("circle").classed("raw",!0).attr("r",u.radius).attr("cy",h).call(n(function(t){var e=r(i.event.x,0,d);t.r=f.invert(e),i.select(this).attr("cx",e),i.select(this.parentElement).select("line").attr("x2",e),s()})),C.select("line").attr({x1:function(t){return g(t.n)},x2:function(t){return f(t.r)}}),C.select("circle.normalized").attr("cx",function(t){return g(t.n)}),C.select("circle.raw").attr("cx",function(t){return f(t.r)}),C.exit().remove()}}function s(){if(!(p.scale instanceof a.ScriptMappingFunction))return void t.select("div.script").style("display","none");t.select("div.script").style("display",null);var n=p.scale,r=t.select("textarea").text(n.code);t.select("div.script").select("button").on("click",function(){n.code=r.property("value"),e(),l()})}function l(t){void 0===t&&(t=!1),t&&"dragend"!==u.triggerCallback||u.callback.call(u.callbackThisArg,p.scale.clone(),p.filter)}function c(){var n=f.domain();t.select("input.raw_min").property("value",n[0]),t.select("input.raw_max").property("value",n[1]),e(),o()}var u=this.options,p=this;t=t.append("div").classed("lugui-me",!0);var d=u.width-2*u.padding_hor,h=u.height-2*u.padding_ver-u.filter_height;t.node().innerHTML='<form onsubmit="return false">\n      <div style="text-align: center"><label for="mapping_type">Mapping Type: <select id="mapping_type">\n        <option value="linear">Linear</option>\n        <option value="linear_invert">Invert</option>\n        <option value="linear_abs">Absolute</option>\n        <option value="log">Log</option>\n        <option value="pow1.1">Pow 1.1</option>\n        <option value="pow2">Pow 2</option>\n        <option value="pow3">Pow 3</option>\n        <option value="sqrt">Sqrt</option>\n        <option value="script">Custom Script</option>\n      </select>\n      </label></div>\n      <div class="mapping_area">\n        <div>\n          <span>0</span>\n          <input type="text" class="raw_min" id="raw_min" value="0"><label for="raw_min">Min</label>\n        </div>\n        <svg width="'+u.width+'" height="'+u.height+'">\n          <line y1="'+u.padding_ver+'" y2="'+u.padding_ver+'" x1="'+u.padding_hor+'" x2="'+(d+u.padding_hor)+'" stroke="black"></line>\n          <rect class="adder" x="'+u.padding_hor+'" width="'+d+'" height="10"></rect>\n          <line y1="'+(u.height-u.filter_height-5)+'" y2="'+(u.height-u.filter_height-5)+'" x1="'+u.padding_hor+'" x2="'+(d+u.padding_hor)+'" stroke="black"></line>\n          <rect class="adder" x="'+u.padding_hor+'" width="'+d+'" height="10" y="'+(u.height-u.filter_height-10)+'"></rect>\n          <g transform="translate('+u.padding_hor+","+u.padding_ver+')">\n            <g class="samples">\n      \n            </g>\n            <g class="mappings">\n      \n            </g>\n            <g class="filter" transform="translate(0,'+(u.height-u.filter_height-10)+')">\n               <g class="left_filter" transform="translate(0,0)">\n                  <path d="M0,0L4,7L-4,7z"></path>\n                  <rect x="-4" y="7" width="40" height="13" rx="2" ry="2"></rect>\n                  <text y="10" x="4" text-anchor="start">&gt; 0</text>\n              </g>\n              <g class="right_filter" transform="translate('+d+',0)">\n                  <path d="M0,0L4,7L-4,7z"></path>\n                  <rect x="-36" y="7" width="40" height="13" rx="2" ry="2"></rect>\n                  <text y="10" x="3" text-anchor="end">&lt; 1</text>\n              </g>\n            </g>\n          </g>\n        </svg>\n        <div>\n          <span>1</span>\n          <input type="text" class="raw_max" id="raw_max" value="1"><label for="raw_max">Max</label>\n        </div>\n      </div>\n      <div class="script" style="/* display: none; */">\n        <label for="script_code">Custom Script</label><button>Apply</button>\n        <textarea id="script_code">\n        </textarea>\n      </div>\n    </form>';var f=i.scale.linear().domain([Math.min(this.scale.domain[0],this.original.domain[0]),Math.max(this.scale.domain[this.scale.domain.length-1],this.original.domain[this.original.domain.length-1])]).range([0,d]),g=i.scale.linear().domain([0,1]).range([0,d]);t.select("input.raw_min").property("value",f.domain()[0]).on("blur",function(){var t=f.domain();t[0]=parseFloat(this.value),f.domain(t);var e=p.scale_.domain;e[0]=t[0],p.scale_.domain=e,c(),l()}),t.select("input.raw_max").property("value",f.domain()[1]).on("blur",function(){var t=f.domain();t[1]=parseFloat(this.value),f.domain(t);var e=p.scale_.domain;e[e.length-1]=t[1],p.scale_.domain=e,c(),l()});var m=t.select("g.samples").selectAll("line").data([]);this.dataPromise.then(function(t){t=i.set(t.map(String)).values().map(parseFloat),m=m.data(t),m.enter().append("line").attr({x1:function(t){return g(p.scale.apply(t))},y1:0,x2:f,y2:h}).style("visibility",function(t){var e=p.scale.domain;return t<e[0]||t>e[e.length-1]?"hidden":null})});var y=[];o(),s();var v=isFinite(this.old_filter.min)?f(this.old_filter.min):0,b=isFinite(this.old_filter.max)?f(this.old_filter.max):d,C=function(t,e){return isFinite(t)?(0===e?">":"<")+t.toFixed(1):"any"};t.selectAll("g.left_filter, g.right_filter").data([this.old_filter.min,this.old_filter.max]).attr("transform",function(t,e){return"translate("+(0===e?v:b)+",0)"}).call(n(function(t,e){var n=r(i.event.x,0,d),o=f.invert(n),a=n<=0&&0===e?-(1/0):n>=d&&1===e?1/0:o;i.select(this).datum(a).attr("transform","translate("+n+",0)").select("text").text(C(a,e))})).select("text").text(C),this.computeFilter=function(){return{min:parseFloat(t.select("g.left_filter").datum()),max:parseFloat(t.select("g.right_filter").datum())}},c(),t.select("select").on("change",function(){var t=this.value;if("linear_invert"===t)p.scale_=new a.ScaleMappingFunction(f.domain(),"linear",[1,0]);else if("linear_abs"===t){var n=f.domain();p.scale_=new a.ScaleMappingFunction([n[0],(n[1]-n[0])/2,n[1]],"linear",[1,0,1])}else"script"===t?p.scale_=new a.ScriptMappingFunction(f.domain()):p.scale_=new a.ScaleMappingFunction(f.domain(),t);e(),o(),s(),l()}).property("selectedIndex",function(){var t="script";p.scale_ instanceof a.ScaleMappingFunction&&(t=p.scale.scaleType);var e=["linear","linear_invert","linear_abs","log","pow1.1","pow2","pow3","sqrt","script"];return e.indexOf(t)})},t}();e.a=s},function(t,e,n){"use strict";function r(t){var e=h.scale.category10().range().slice();return t.forEach(function(t){switch(t.type){case"number":t.color=e.shift()}}),t}function i(t,e,n){return void 0===n&&(n={}),new l.LocalDataProvider(t,e,n)}function o(t,e,n){return void 0===n&&(n={}),new x(e,t,n)}var a=n(7),s=(n.n(a),n(2)),l=n(5),c=n(3),u=n(6),p=n(1),d=n(4),h=n(0);n.n(h);n.d(e,"model",function(){return g}),n.d(e,"provider",function(){return m}),n.d(e,"renderer",function(){return y}),n.d(e,"ui",function(){return v}),n.d(e,"utils",function(){return b}),n.d(e,"ui_dialogs",function(){return C}),n.d(e,"LineUp",function(){return x}),e.deriveColors=r,e.createLocalStorage=i,e.create=o;var f=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},g=s,m=l,y=c,v=u,b=p,C=d,x=function(t){function e(n,r,i){var o=this;void 0===i&&(i={}),t.call(this),this.data=r,this.config={idPrefix:Math.random().toString(36).slice(-8).substr(0,3),header:{headerHeight:20,headerHistogramHeight:40,autoRotateLabels:!1,rotationHeight:50,rotationDegree:-20,rankingButtons:u.dummyRankingButtonHook,linkTemplates:[]},htmlLayout:{},renderingOptions:{stacked:!0,animation:!0,histograms:!1,meanLine:!1},body:{renderer:"svg",rowHeight:17,rowPadding:.2,rowBarPadding:1,visibleRowsOnly:!0,
backupScrollRows:4,animationDuration:1e3,freezeCols:0,rowActions:[]},svgLayout:{},manipulative:!0,pool:!1,renderers:c.renderers()},this.body=null,this.header=null,this.pools=[],this.contentScroller=null,this.isUpdateInitialized=!1,this.$container=n instanceof h.selection?n:h.select(n),this.$container=this.$container.append("div").classed("lu",!0),this.config.svgLayout=this.config.body,this.config.htmlLayout=this.config.header,b.merge(this.config,i),this.data.on("selectionChanged.main",this.triggerSelection.bind(this)),this.header=new u.HeaderRenderer(r,this.node,{manipulative:this.config.manipulative,headerHeight:this.config.header.headerHeight,headerHistogramHeight:this.config.header.headerHistogramHeight,histograms:this.config.renderingOptions.histograms,autoRotateLabels:this.config.header.autoRotateLabels,rotationHeight:this.config.header.rotationHeight,rotationDegree:this.config.header.rotationDegree,freezeCols:this.config.body.freezeCols,rankingButtons:this.config.header.rankingButtons,linkTemplates:this.config.header.linkTemplates}),this.body=new("svg"===this.config.body.renderer?u.BodyRenderer:u.BodyCanvasRenderer)(r,this.node,this.slice.bind(this),{rowHeight:this.config.body.rowHeight,rowPadding:this.config.body.rowPadding,rowBarPadding:this.config.body.rowBarPadding,animationDuration:this.config.body.animationDuration,meanLine:this.config.renderingOptions.meanLine,animation:this.config.renderingOptions.animation,stacked:this.config.renderingOptions.stacked,actions:this.config.body.rowActions,idPrefix:this.config.idPrefix,freezeCols:this.config.body.freezeCols,renderers:this.config.renderers}),this.body.histCache=this.header.sharedHistCache,this.forward(this.body,e.EVENT_HOVER_CHANGED),this.config.pool&&this.config.manipulative&&this.addPool(new u.PoolRenderer(r,this.node,this.config)),this.config.body.visibleRowsOnly&&(this.contentScroller=new p.ContentScroller(this.$container.node(),this.body.node,{backupRows:this.config.body.backupScrollRows,rowHeight:this.config.body.rowHeight,topShift:function(){return o.header.currentHeight()}}),this.contentScroller.on("scroll",function(t,e){o.header.$node.style("transform","translate(0px,"+t+"px)"),o.config.body.freezeCols>0&&(o.header.updateFreeze(e),o.body.updateFreeze(e))}),this.contentScroller.on("redraw",this.body.update.bind(this.body)))}return f(e,t),e.prototype.createEventList=function(){return t.prototype.createEventList.call(this).concat([e.EVENT_HOVER_CHANGED,e.EVENT_SELECTION_CHANGED,e.EVENT_MULTISELECTION_CHANGED,e.EVENT_UPDATE_START,e.EVENT_UPDATE_FINISHED])},e.prototype.addPool=function(t,e){return void 0===e&&(e=this.config),t instanceof u.PoolRenderer?this.pools.push(t):this.pools.push(new u.PoolRenderer(this.data,t,e)),this.pools[this.pools.length-1]},Object.defineProperty(e.prototype,"node",{get:function(){return this.$container.node()},enumerable:!0,configurable:!0}),e.prototype.slice=function(t,e,n){return this.contentScroller?this.contentScroller.select(t,e,n):{from:t,to:e}},e.prototype.destroy=function(){this.pools.forEach(function(t){return t.remove()}),this.$container.remove(),this.contentScroller&&this.contentScroller.destroy()},e.prototype.sortBy=function(t,e){void 0===e&&(e=!1);var n=this.data.find(t);return n&&n.sortByMe(e),null!==n},e.prototype.dump=function(){return this.data.dump()},e.prototype.changeDataStorage=function(t,e){this.data&&this.data.on("selectionChanged.main",null),this.data=t,e&&this.data.restore(e),this.data.on("selectionChanged.main",this.triggerSelection.bind(this)),this.header.changeDataStorage(t),this.body.changeDataStorage(t),this.pools.forEach(function(e){return e.changeDataStorage(t)}),this.update()},e.prototype.triggerSelection=function(t){this.fire(e.EVENT_SELECTION_CHANGED,t.length>0?t[0]:-1),this.fire(e.EVENT_MULTISELECTION_CHANGED,t)},e.prototype.restore=function(t){this.changeDataStorage(this.data,t)},e.prototype.update=function(){var t=this,n=this.isUpdateInitialized?1:3;this.isUpdateInitialized=!0,this.fire(e.EVENT_UPDATE_START),this.header.update(),this.body.update(),this.pools.forEach(function(t){return t.update()}),this.body.on("renderFinished",function(){n-=1,0===n&&t.fire(e.EVENT_UPDATE_FINISHED)})},e.prototype.changeRenderingOption=function(t,e){this.config.renderingOptions[t]=e,"animation"!==t&&"stacked"!==t||(this.body.setOption(t,e),this.body.update())},e.EVENT_HOVER_CHANGED="hoverChanged",e.EVENT_SELECTION_CHANGED="selectionChanged",e.EVENT_MULTISELECTION_CHANGED="multiSelectionChanged",e.EVENT_UPDATE_START="updateStart",e.EVENT_UPDATE_FINISHED="updateFinished",e}(p.AEventDispatcher)}])});